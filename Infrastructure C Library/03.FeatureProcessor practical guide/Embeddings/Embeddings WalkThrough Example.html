
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for Medial EarlySign's projects and tools.">
      
      
        <meta name="author" content="Medial EarlySign">
      
      
        <link rel="canonical" href="https://medial-earlysign.github.io/MR_Wiki/Infrastructure%20C%20Library/03.FeatureProcessor%20practical%20guide/Embeddings/Embeddings%20WalkThrough%20Example.html">
      
      
        <link rel="prev" href="index.html">
      
      
        <link rel="next" href="../../04.MedAlgo%20Library/index.html">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Embeddings WalkThrough Example - Medial EarlySign Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.e53b48f4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Segoe+UI:300,300i,400,400i,700,700i%7CConsolas,+'Courier+New',+monospace:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Segoe UI";--md-code-font:"Consolas, 'Courier New', monospace"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#embeddings-walkthrough-example" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../index.html" title="Medial EarlySign Documentation" class="md-header__button md-logo" aria-label="Medial EarlySign Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Medial EarlySign Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Embeddings WalkThrough Example
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Medial-EarlySign/MR_WIki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../index.html" class="md-tabs__link">
        
  
  
    
  
  Wikimedial

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../index.html" class="md-tabs__link">
          
  
  
    
  
  Infrastructure C Library

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Installation/index.html" class="md-tabs__link">
          
  
  
    
  
  Installation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Medial%20Tools/index.html" class="md-tabs__link">
          
  
  
    
  
  Medial Tools

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Models/index.html" class="md-tabs__link">
          
  
  
    
  
  Models

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Python/index.html" class="md-tabs__link">
          
  
  
    
  
  Python

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Repositories/index.html" class="md-tabs__link">
          
  
  
    
  
  Repositories

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Research/index.html" class="md-tabs__link">
          
  
  
    
  
  Research

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.html" title="Medial EarlySign Documentation" class="md-nav__button md-logo" aria-label="Medial EarlySign Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Medial EarlySign Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Medial-EarlySign/MR_WIki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Wikimedial
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Infrastructure C Library
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Infrastructure C Library
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Infrastructure%20Application%20Version.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Infrastructure Application Version
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedModel%20json%20format.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MedModel JSON Format
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../00.InfraMed%20Library%20page/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    00.InfraMed Library page
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            00.InfraMed Library page
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.InfraMed%20Library%20page/Generic%20%28Universal%29%20Signal%20Vectors.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generic (Universal) Signal Vectors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.InfraMed%20Library%20page/MedDictionary.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MedDictionary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.InfraMed%20Library%20page/MedRepository.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MedRepository
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.InfraMed%20Library%20page/MedSignals%20_%20Unified%20Signals.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MedSignals / Unified Signals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.InfraMed%20Library%20page/PidDynamicRec.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PidDynamicRec
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../01.Rep%20Processors%20Practical%20Guide/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    01.Rep Processors Practical Guide
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            01.Rep Processors Practical Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.Rep%20Processors%20Practical%20Guide/Cleaners%20Json%20Examples.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cleaners Json Examples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.Rep%20Processors%20Practical%20Guide/Full%20Rep%20Processor.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Full Rep Processor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.Rep%20Processors%20Practical%20Guide/History%20Limit%20repo%20processor.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    History Limit repo processor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.Rep%20Processors%20Practical%20Guide/How%20to%20print%2C%20how%20many%20outliers%20were.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to print, how many outliers were
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.Rep%20Processors%20Practical%20Guide/How%20to%20remove%20signal%20during%20admissions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to remove signal during admissions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.Rep%20Processors%20Practical%20Guide/How%20to%20rename%20signal.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to rename signal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.Rep%20Processors%20Practical%20Guide/Howto%20write%20RepProcessor.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to Write a RepProcessor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.Rep%20Processors%20Practical%20Guide/Noiser.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Noiser
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.Rep%20Processors%20Practical%20Guide/Rep%20Calculator.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rep Calculator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.Rep%20Processors%20Practical%20Guide/Virtual%20Signals.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Virtual Signals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5_12" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../01.Rep%20Processors%20Practical%20Guide/How%20to%20create%20an%20empty%20signal/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    How to create an empty signal
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_5_12" id="__nav_2_5_12_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_5_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5_12">
            <span class="md-nav__icon md-icon"></span>
            How to create an empty signal
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.Rep%20Processors%20Practical%20Guide/How%20to%20create%20an%20empty%20signal/Howto%20create%20a%20signal%20with%20constant%20value.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Howto create a signal with constant value
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../02.Feature%20Generator%20Practical%20Guide/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    02.Feature Generator Practical Guide
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            02.Feature Generator Practical Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02.Feature%20Generator%20Practical%20Guide/BasicFeatGenerator.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BasicFeatGenerator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02.Feature%20Generator%20Practical%20Guide/Howto%20write%20Feature%20Generator.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to Write a Feature Generator
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    03.FeatureProcessor practical guide
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            03.FeatureProcessor practical guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Charlson.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Charlson
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Framingham%20Feature%20Processor.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Framingham Feature Processor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Howto%20write%20Feature%20Processor.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to Write a Feature Processor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7_5" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Embeddings
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_7_5" id="__nav_2_7_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_7_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_7_5">
            <span class="md-nav__icon md-icon"></span>
            Embeddings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Embeddings WalkThrough Example
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="Embeddings%20WalkThrough%20Example.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Embeddings WalkThrough Example
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-1-plan" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1 : Plan
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-prepare-basic-lists-and-cohort" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Prepare basic lists , and cohort
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-design-and-prepare-the-training-dates-for-embeddings" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3 : Design and prepare the training dates for embeddings
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-prepare-the-embed_params-files-for-x-and-y" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4 : Prepare the embed_params files for x and y
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-create-the-x-and-y-matrices" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Create the x and y matrices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 5: Create the x and y matrices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#files-created-ls-l" class="md-nav__link">
    <span class="md-ellipsis">
      files created (ls -l) :
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#and-now-creating-the-y-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      and now creating the y matrix
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-train-the-embedding-using-keras" class="md-nav__link">
    <span class="md-ellipsis">
      Step 6: Train the embedding using Keras
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-7-testing-we-get-the-same-embeddings-in-keras-and-infrastructure" class="md-nav__link">
    <span class="md-ellipsis">
      Step 7 : Testing we get the same embeddings in Keras and Infrastructure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 7 : Testing we get the same embeddings in Keras and Infrastructure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#this-created-the-xtestsmat-file" class="md-nav__link">
    <span class="md-ellipsis">
      this created the xtest.smat file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#we-can-now-check-it-directly-with-keras-using-the-following-line-the-model-will-initialize-from-the-json-and-h35-files" class="md-nav__link">
    <span class="md-ellipsis">
      we can now check it directly with keras using the following line (the model will initialize from the .json and .h35 files):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-is" class="md-nav__link">
    <span class="md-ellipsis">
      result is :
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#results" class="md-nav__link">
    <span class="md-ellipsis">
      results ...
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-8-using-embedding-in-a-medmodel-finally" class="md-nav__link">
    <span class="md-ellipsis">
      Step 8 : Using Embedding In a MedModel (Finally !!)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-9-results-for-mi-withwithout-embedding-withwithout-sigdep" class="md-nav__link">
    <span class="md-ellipsis">
      Step 9 : Results for MI with/without Embedding , with/without SigDep
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../04.MedAlgo%20Library/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    04.MedAlgo Library
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            04.MedAlgo Library
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04.MedAlgo%20Library/Feature%20Importance.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feature Importance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04.MedAlgo%20Library/Machine%20Learning%20Algorithms%20-%20Parameter%20Tuning%20%28C%2B%2B%20Code%29.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Machine Learning Algorithms - Parameter Tuning (C++ Code)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04.MedAlgo%20Library/but_why%20-%20feature%20contribs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    but_why - feature contribs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../04.MedAlgo%20Library/MedPredictor%20practical%20guide/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    MedPredictor practical guide
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_8_5" id="__nav_2_8_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_8_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8_5">
            <span class="md-nav__icon md-icon"></span>
            MedPredictor practical guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04.MedAlgo%20Library/MedPredictor%20practical%20guide/Howto%20write%20MedPredictor.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to Write a MedPredictor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04.MedAlgo%20Library/MedPredictor%20practical%20guide/MASK%20predictor%20-%20predict%20by_missing_value_subset.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MASK predictor - predict by_missing_value_subset
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04.MedAlgo%20Library/MedPredictor%20practical%20guide/XGBoost%20added%20features.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    XGBoost added features
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../05.PostProcessors%20Practical%20Guide/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    05.PostProcessors Practical Guide
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_9" id="__nav_2_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_9">
            <span class="md-nav__icon md-icon"></span>
            05.PostProcessors Practical Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05.PostProcessors%20Practical%20Guide/ButWhy%20Practical%20Guide.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ButWhy Practical Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05.PostProcessors%20Practical%20Guide/Explainers%20%28But%20Why%29.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Explainers (But Why)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05.PostProcessors%20Practical%20Guide/FairnessPostProcessor.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FairnessPostProcessor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05.PostProcessors%20Practical%20Guide/Howto%20write%20PostProcessor.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to Write a PostProcessor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05.PostProcessors%20Practical%20Guide/MultipleImputations.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MultipleImputations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_10" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../AlgoMarkers/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    AlgoMarkers
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_10" id="__nav_2_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_10">
            <span class="md-nav__icon md-icon"></span>
            AlgoMarkers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AlgoMarkers/Howto%20Use%20AlgoMarker.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Howto Use AlgoMarker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AlgoMarkers/Request%20Json%20Format.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Request Json Format
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AlgoMarkers/Setup%20a%20new%20AlgoMarker.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setup a new AlgoMarker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AlgoMarkers/The%20new%20DllAPITester.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The new DllAPITester
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_11" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../MedProcessTools%20Library/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    MedProcessTools Library
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_11" id="__nav_2_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_11">
            <span class="md-nav__icon md-icon"></span>
            MedProcessTools Library
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/MedBootstrap.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MedBootstrap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/MedCohort.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MedCohort
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/MedFeatures.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MedFeatures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/MedLabels.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MedLabels
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/MedModel.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MedModel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/MedPlot.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MedPlot
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/MedSamples.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MedSamples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/SerializableObject.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SerializableObject
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_11_10" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../MedProcessTools%20Library/FeatureGenerator/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    FeatureGenerator
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_11_10" id="__nav_2_11_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_11_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_11_10">
            <span class="md-nav__icon md-icon"></span>
            FeatureGenerator
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/FeatureGenerator/ModelFeatGenerator.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ModelFeatGenerator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_11_10_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../MedProcessTools%20Library/FeatureGenerator/Unified%20Smoking%20Feature%20Generator/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Unified Smoking Feature Generator
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_11_10_3" id="__nav_2_11_10_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_11_10_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_11_10_3">
            <span class="md-nav__icon md-icon"></span>
            Unified Smoking Feature Generator
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/FeatureGenerator/Unified%20Smoking%20Feature%20Generator/Code%20Documnetation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code Documnetation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_11_11" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../MedProcessTools%20Library/FeatureProcessor/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    FeatureProcessor
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_11_11" id="__nav_2_11_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_11_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_11_11">
            <span class="md-nav__icon md-icon"></span>
            FeatureProcessor
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/FeatureProcessor/FeatureSelector.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FeatureSelector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_11_11_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../MedProcessTools%20Library/FeatureProcessor/FeatureEncoder/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    FeatureEncoder
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_11_11_3" id="__nav_2_11_11_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_11_11_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_11_11_3">
            <span class="md-nav__icon md-icon"></span>
            FeatureEncoder
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/FeatureProcessor/FeatureEncoder/FeaturePCA.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FeaturePCA
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_11_12" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../MedProcessTools%20Library/MedRegistry/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    MedRegistry
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_11_12" id="__nav_2_11_12_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_11_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_11_12">
            <span class="md-nav__icon md-icon"></span>
            MedRegistry
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/MedRegistry/MedSamplingStrategy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MedSamplingStrategy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/MedRegistry/TimeWindowInteraction.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TimeWindowInteraction
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_11_13" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../MedProcessTools%20Library/RepProcessor/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    RepProcessor
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_11_13" id="__nav_2_11_13_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_11_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_11_13">
            <span class="md-nav__icon md-icon"></span>
            RepProcessor
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/RepProcessor/MedValueCleaner.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MedValueCleaner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/RepProcessor/RepAggregationPeriod.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RepAggregationPeriod
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/RepProcessor/RepBasicOutlierCleaner.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RepBasicOutlierCleaner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/RepProcessor/RepBasicRangeCleaner.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RepBasicRangeCleaner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/RepProcessor/RepConfiguredOutlierCleaner.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RepConfiguredOutlierCleaner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/RepProcessor/RepMultiProcessor.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RepMultiProcessor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/RepProcessor/RepNbrsOutlierCleaner.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RepNbrsOutlierCleaner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/RepProcessor/RepRulebasedOutlierCleaner.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RepRulebasedOutlierCleaner
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_11_14" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../MedProcessTools%20Library/SampleFilter/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    SampleFilter
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_11_14" id="__nav_2_11_14_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_11_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_11_14">
            <span class="md-nav__icon md-icon"></span>
            SampleFilter
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/SampleFilter/BasicSampleFilter.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BasicSampleFilter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/SampleFilter/BasicTestFilter.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BasicTestFilter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/SampleFilter/BasicTrainFilter.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BasicTrainFilter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/SampleFilter/MatchingSampleFilter.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MatchingSampleFilter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MedProcessTools%20Library/SampleFilter/OutlierSampleFilter.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OutlierSampleFilter
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Installation/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Medial%20Tools/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Medial Tools
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Medial Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Compare%20AUC%27s.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compare AUC's
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Doxygen.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Doxygen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Fairness%20extraction.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fairness Extraction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Howto%20Debug%20Program%20in%20Linux.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Howto Debug Program in Linux
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Iterative%20Feature%20Selector.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Iterative Feature Selector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Optimizer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimizer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Simulator.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simulator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/TestModelExternal.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TestModelExternal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/adjust_model.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    adjust_model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/model_signals_importance.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    model_signals_importance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_12" >
        
          
          <label class="md-nav__link" for="__nav_4_12" id="__nav_4_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Deprecated
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_12">
            <span class="md-nav__icon md-icon"></span>
            Deprecated
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Deprecated/Find%20Required%20Signals.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Find Required Signals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Deprecated/SignalsDependencies.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SignalsDependencies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Deprecated/action_outcome_effect.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    action_outcome_effect
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_12_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Medial%20Tools/Deprecated/GANs%20for%20imputing%20matrices/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    GANs for imputing matrices
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_12_4" id="__nav_4_12_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_12_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_12_4">
            <span class="md-nav__icon md-icon"></span>
            GANs for imputing matrices
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Deprecated/GANs%20for%20imputing%20matrices/TrainingMaskedGAN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TrainingMaskedGAN
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_12_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Medial%20Tools/Deprecated/create_registry/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Create registry
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_12_5" id="__nav_4_12_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_12_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_12_5">
            <span class="md-nav__icon md-icon"></span>
            Create registry
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Deprecated/create_registry/Create%20Membership%20registry%20example%20command.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Create Membership registry example command
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_13" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Medial%20Tools/Guide%20for%20common%20actions/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Guide for common actions
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_13" id="__nav_4_13_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_13">
            <span class="md-nav__icon md-icon"></span>
            Guide for common actions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Guide%20for%20common%20actions/AlgoMarker%20common%20actions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AlgoMarker common actions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Guide%20for%20common%20actions/Calibrate%20model%2C%20and%20calibration%20test.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Calibrate model, and calibration test
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Guide%20for%20common%20actions/DevOps.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DevOps
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_14" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Medial%20Tools/Model%20Checklist/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Model Checklist
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_14" id="__nav_4_14_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_14">
            <span class="md-nav__icon md-icon"></span>
            Model Checklist
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_14_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    AutoTest
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_14_2" id="__nav_4_14_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_14_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_14_2">
            <span class="md-nav__icon md-icon"></span>
            AutoTest
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_14_2_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/Development%20kit/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Development kit
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_14_2_2" id="__nav_4_14_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_14_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_14_2_2">
            <span class="md-nav__icon md-icon"></span>
            Development kit
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/Development%20kit/Test_01%20-%20test_train_samples_over_years.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test_01 - test_train_samples_over_years
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/Development%20kit/Test_02%20-%20test%20samples.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test_02 - test samples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/Development%20kit/Test_03%20-%20test%20cleaners.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test_03 - test cleaners
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/Development%20kit/Test_04%20-%20test%20imputers.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test_04 - test imputers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/Development%20kit/Test_05%20-%20But%20why.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test_05 - But why
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/Development%20kit/Test_06%20-%20bootstrap%20results.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test_06 - bootstrap results
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/Development%20kit/Test_07%20-%20feature%20importance.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test_07 - feature importance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/Development%20kit/Test_08%20-%20calibration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test_08 - calibration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/Development%20kit/Test_09%20-%20coverage.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test_09 - coverage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/Development%20kit/Test_10%20-%20test%20matrix%20features.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test_10 - test matrix features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/Development%20kit/Test_11%20-%20test%20matrix%20over%20years.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test_11 - test matrix over years
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/Development%20kit/Test_12%20-%20fairness.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test_12 - fairness
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/Development%20kit/Test_13%20-%20model%20explainability.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test_13 - model explainability
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/Development%20kit/Test_14%20-%20noise%20sensitivity%20analysis.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test_14 - noise sensitivity analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/Development%20kit/Test_15%20-%20compare%20to%20baseline%20model.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test_15 - compare to baseline model
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_14_2_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/External%20Silent%20Run/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    External Silent Run
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_14_2_3" id="__nav_4_14_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_14_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_14_2_3">
            <span class="md-nav__icon md-icon"></span>
            External Silent Run
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/External%20Silent%20Run/TODO.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TODO
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/External%20Silent%20Run/Test%201%20-%20Generate%20Repository.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test 1 - Generate Repository
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/External%20Silent%20Run/Test%2010_12%20-%20butwhy%20%28TBD%29.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test 10/12 - butwhy (TBD)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/External%20Silent%20Run/Test%2011%20-%20Sample%20Dates.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test 11 - Sample Dates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/External%20Silent%20Run/Test%2013%20-%20Features%20and%20Flagged%20%28TBD%29.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test 13 - Features and Flagged (TBD)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/External%20Silent%20Run/Test%202%20-%20Compare%20Repository%20with%20Reference%20Matrix.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test 2 - Compare Repository with Reference Matrix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/External%20Silent%20Run/Test%203%20%26%204%20-%20Compare%20Score%20Distribution.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test 3 &amp; 4 - Compare Score Distribution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/External%20Silent%20Run/Test%205%20-%20Sex%20Ratio.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test 5 - Sex Ratio
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/External%20Silent%20Run/Test%206%20-%20Special%20Groups.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test 6 - Special Groups
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/External%20Silent%20Run/Test%207%20-%20Compare%20Important%20Feature.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test 7 - Compare Important Feature
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/External%20Silent%20Run/Test%208%20-%20Estimate%20Performances.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test 8 - Estimate Performances
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/External%20Silent%20Run/Test%209%20-%20Lab%20Frequency.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test 9 - Lab Frequency
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Model%20Checklist/AutoTest/External%20Silent%20Run/Tips%20and%20Scripts.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tips and Scripts
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_15" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Medial%20Tools/Using%20the%20Flow%20App/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Using the Flow App
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_15" id="__nav_4_15_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_15">
            <span class="md-nav__icon md-icon"></span>
            Using the Flow App
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Using%20the%20Flow%20App/Fit%20MedModel%20to%20Repository.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fitting a MedModel to a Repository
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Using%20the%20Flow%20App/Split%20Files.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Split Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Using%20the%20Flow%20App/Using%20Flow%20To%20Prepare%20Samples%20and%20Get%20Incidences.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Flow to Prepare Samples and Calculate Incidences
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/Using%20the%20Flow%20App/Using%20Pre%20Processors.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Pre Processors
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_16" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Medial%20Tools/bootstrap_app/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Bootstrap app
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_16" id="__nav_4_16_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_16">
            <span class="md-nav__icon md-icon"></span>
            Bootstrap app
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/bootstrap_app/Bootstrap%20legend.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bootstrap legend
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/bootstrap_app/Utility%20tools%20to%20process%20bootstrap%20results.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utility tools to process bootstrap results
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_16_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Medial%20Tools/bootstrap_app/Extending%20bootstrap/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Extending bootstrap
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_16_4" id="__nav_4_16_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_16_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_16_4">
            <span class="md-nav__icon md-icon"></span>
            Extending bootstrap
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/bootstrap_app/Extending%20bootstrap/Using%20Harrell%20C%20Statistics.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Harrell C Statistics
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_17" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Medial%20Tools/change_model/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Change model
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_17" id="__nav_4_17_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_17">
            <span class="md-nav__icon md-icon"></span>
            Change model
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Medial%20Tools/change_model/How%20to%20limit%20memory%20usage%20in%20predict.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Limiting Memory Usage in predict
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Models/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Models/AAA.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AAA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Models/COPDCMS.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Unplanned COPD Admission Prediction Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Models/ColonFlag.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LGI/Colon-Flag
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Models/FastProgressors.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FastProgressor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Models/FluComplications.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FluComplications
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Models/GastroFlag.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GastroFlag
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Models/LungFlag.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LungFlag
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Models/MortatlityCMS.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mortality Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Models/Pred2D.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pre2D
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Python/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Python/Examples.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Python/Extend%20and%20Develop.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Extending and Developing the Medial C++ API for Python
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Python/Python%20AlgoMarker%20API%20Wrapper.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python AlgoMarker API Wrapper
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Python/Python%20binding%20Troubleshooting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python Binding Troubleshooting
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Repositories/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Repositories
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Repositories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Repositories/Load%20new%20repository.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Loading a New Repository
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Repositories/Medical%20vocabulary%20mappings.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Medical vocabulary mappings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Repositories/Repository%20Signals%20file%20format.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Repository Signals File Format
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Repositories/Repository%20Viewers.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Repository Viewers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Repositories/Solution%20details%20-%20ETL_process%20tool/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Solution details   ETL process tool
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_6" id="__nav_7_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6">
            <span class="md-nav__icon md-icon"></span>
            Solution details   ETL process tool
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Repositories/Solution%20details%20-%20ETL_process%20tool/ETL_process%20TODO.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ETL_process TODO
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Repositories/Solution%20details%20-%20ETL_process%20tool/ETL%20Tutorial/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    ETL Tutorial
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_6_3" id="__nav_7_6_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6_3">
            <span class="md-nav__icon md-icon"></span>
            ETL Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Repositories/Solution%20details%20-%20ETL_process%20tool/ETL%20Tutorial/ETL_process%20dynamic%20testing%20of%20signals.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ETL Process – Dynamic Testing of Signals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6_3_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Repositories/Solution%20details%20-%20ETL_process%20tool/ETL%20Tutorial/00.Setup/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    00.Setup
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_7_6_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6_3_3">
            <span class="md-nav__icon md-icon"></span>
            00.Setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6_3_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Repositories/Solution%20details%20-%20ETL_process%20tool/ETL%20Tutorial/01.Data%20Fetching%20step/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    01.Data Fetching step
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_7_6_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6_3_4">
            <span class="md-nav__icon md-icon"></span>
            01.Data Fetching step
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6_3_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Repositories/Solution%20details%20-%20ETL_process%20tool/ETL%20Tutorial/02.Process%20Pipeline/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    02.Process Pipeline
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_6_3_5" id="__nav_7_6_3_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_7_6_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6_3_5">
            <span class="md-nav__icon md-icon"></span>
            02.Process Pipeline
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Repositories/Solution%20details%20-%20ETL_process%20tool/ETL%20Tutorial/02.Process%20Pipeline/Categorical%20signal_%20Custom%20dictionaries.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Categorical Signals &amp; Custom Dictionaries
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6_3_5_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Repositories/Solution%20details%20-%20ETL_process%20tool/ETL%20Tutorial/02.Process%20Pipeline/unit_conversion/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Unit conversion
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_6_3_5_3" id="__nav_7_6_3_5_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_7_6_3_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6_3_5_3">
            <span class="md-nav__icon md-icon"></span>
            Unit conversion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Repositories/Solution%20details%20-%20ETL_process%20tool/ETL%20Tutorial/02.Process%20Pipeline/unit_conversion/Full%20code%20example%20-%20LungFlag%20Taiwan%20labs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Full code example
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Repositories/Solution%20details%20-%20ETL_process%20tool/ETL%20Tutorial/02.Process%20Pipeline/unit_conversion/config%20file%20of%20unit%20conversion.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Example config/output file of unit conversion
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6_3_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Repositories/Solution%20details%20-%20ETL_process%20tool/ETL%20Tutorial/03.Finalize%20Load/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    03.Finalize Load
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_7_6_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6_3_6">
            <span class="md-nav__icon md-icon"></span>
            03.Finalize Load
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Repositories/Solution%20details%20-%20ETL_process%20tool/High%20level%20-%20important%20paths/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    High level   important paths
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_6_4" id="__nav_7_6_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6_4">
            <span class="md-nav__icon md-icon"></span>
            High level   important paths
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Repositories/Solution%20details%20-%20ETL_process%20tool/High%20level%20-%20important%20paths/CODE_DIR.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    📁 CODE_DIR: Your ETL Workspace
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Repositories/Solution%20details%20-%20ETL_process%20tool/High%20level%20-%20important%20paths/ETL_INFRA_DIR.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    📂 ETL_INFRA_DIR: A Closer Look
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Repositories/Solution%20details%20-%20ETL_process%20tool/High%20level%20-%20important%20paths/WORK_DIR.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    📁 WORK_DIR: The Output Directory
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Research/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Research
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Research
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Research/Factorization%20Machines.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Factorization Machines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Research/Journal%20Club%20Page.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Journal Club Page
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Research/Missing%20Values%20Based%20Uncertainty%20Analysis.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Missing Values Based Uncertainty Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Research/Raindrop.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Raindrop
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Research/Right%20Censoring.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Right Censoring
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Research/But%20Why%20-%20Explainers/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    But Why   Explainers
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8_7" id="__nav_8_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_7">
            <span class="md-nav__icon md-icon"></span>
            But Why   Explainers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Research/But%20Why%20-%20Explainers/Experiments%20-%20Stage%20B.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Experiments - Stage B
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Research/But%20Why%20-%20Explainers/Experiments%20-%20Stage%20C%20%28Freeze%20Version%201%29.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Experiments - Stage C (Freeze Version 1)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Research/But%20Why%20-%20Explainers/Sanity%20test%20experiment%20for%20debuging.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sanity test experiment for debuging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_7_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Research/But%20Why%20-%20Explainers/ButWhy%20experiments%20results/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    ButWhy experiments results
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8_7_5" id="__nav_8_7_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_7_5">
            <span class="md-nav__icon md-icon"></span>
            ButWhy experiments results
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Research/But%20Why%20-%20Explainers/ButWhy%20experiments%20results/TestGibbs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TestGibbs
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Research/Conferences/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Conferences
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8_8" id="__nav_8_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_8">
            <span class="md-nav__icon md-icon"></span>
            Conferences
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Research/Conferences/AIME%202019.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AIME 2019
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Research/Conferences/Boston%20MLHC%20%28ML%20in%20HealthCare%29%202017.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Boston MLHC (ML in HealthCare) 2017
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Research/Conferences/KDD%202017.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    KDD 2017
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Research/What-If/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    What If
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8_9" id="__nav_8_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_9">
            <span class="md-nav__icon md-icon"></span>
            What If
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Research/What-If/An%20envelope%20script%20for%20Causal%20Inference%20on%20Synthetic%20Data.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    An envelope script for Causal Inference on Synthetic Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Research/What-If/Checking%20Causal%20Inference%20on%20Synthetic%20Data.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Checking Causal Inference on Synthetic Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Research/What-If/Generating%20Syntethic%20Data%20for%20Causal-Inference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generating Syntethic Data for Causal-Inference
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-1-plan" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1 : Plan
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-prepare-basic-lists-and-cohort" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Prepare basic lists , and cohort
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-design-and-prepare-the-training-dates-for-embeddings" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3 : Design and prepare the training dates for embeddings
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-prepare-the-embed_params-files-for-x-and-y" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4 : Prepare the embed_params files for x and y
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-create-the-x-and-y-matrices" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Create the x and y matrices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 5: Create the x and y matrices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#files-created-ls-l" class="md-nav__link">
    <span class="md-ellipsis">
      files created (ls -l) :
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#and-now-creating-the-y-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      and now creating the y matrix
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-train-the-embedding-using-keras" class="md-nav__link">
    <span class="md-ellipsis">
      Step 6: Train the embedding using Keras
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-7-testing-we-get-the-same-embeddings-in-keras-and-infrastructure" class="md-nav__link">
    <span class="md-ellipsis">
      Step 7 : Testing we get the same embeddings in Keras and Infrastructure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 7 : Testing we get the same embeddings in Keras and Infrastructure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#this-created-the-xtestsmat-file" class="md-nav__link">
    <span class="md-ellipsis">
      this created the xtest.smat file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#we-can-now-check-it-directly-with-keras-using-the-following-line-the-model-will-initialize-from-the-json-and-h35-files" class="md-nav__link">
    <span class="md-ellipsis">
      we can now check it directly with keras using the following line (the model will initialize from the .json and .h35 files):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-is" class="md-nav__link">
    <span class="md-ellipsis">
      result is :
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#results" class="md-nav__link">
    <span class="md-ellipsis">
      results ...
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-8-using-embedding-in-a-medmodel-finally" class="md-nav__link">
    <span class="md-ellipsis">
      Step 8 : Using Embedding In a MedModel (Finally !!)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-9-results-for-mi-withwithout-embedding-withwithout-sigdep" class="md-nav__link">
    <span class="md-ellipsis">
      Step 9 : Results for MI with/without Embedding , with/without SigDep
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/Medial-EarlySign/MR_WIki/edit/main/Infrastructure C Library/03.FeatureProcessor practical guide/Embeddings/Embeddings WalkThrough Example.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/Medial-EarlySign/MR_WIki/raw/main/Infrastructure C Library/03.FeatureProcessor practical guide/Embeddings/Embeddings WalkThrough Example.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="embeddings-walkthrough-example">Embeddings WalkThrough Example</h1>
<p>In this example we will first create an unsupervised embedding space, and then use it as features for predicting the first CVD MI.
All work done here can be found in: /nas1/Work/Users/Avi/test_problems/embedding_example
The code needed for this is either in MR_LIBS or in MR/Projects/Shared/Embeddings.
Quick Jump:</p>
<ul>
<li><a href="#step-1-plan">Step 1 : Plan</a></li>
<li><a href="#step-2-prepare-basic-lists-and-cohort">Step 2: Prepare basic lists , and cohort</a></li>
<li><a href="#step-3-design-and-prepare-the-training-dates-for-embeddings">Step 3 : Design and prepare the training dates for embeddings</a></li>
<li><a href="#step-4-prepare-the-embed_params-files-for-x-and-y">Step 4 : Prepare the embed_params files for x and y</a></li>
<li><a href="#step-5-create-the-x-and-y-matrices">Step 5: Create the x and y matrices </a></li>
<li><a href="#step-6-train-the-embedding-using-keras">Step 6: Train the embedding using Keras</a></li>
<li><a href="#step-7-testing-we-get-the-same-embeddings-in-keras-and-infrastructure">Step 7 : Testing we get the same embeddings in Keras and Infrastructure</a></li>
<li><a href="#step-8-using-embedding-in-a-medmodel-finally">Step 8 : Using Embedding In a MedModel</a></li>
<li><a href="#step-9-results-for-mi-withwithout-embedding-withwithout-sigdep">Step 9 : Results for MI with/without Embedding , with/without SigDep</a>
 </li>
</ul>
<h2 id="step-1-plan">Step 1 : Plan</h2>
<p>Our plan is to use the CVD_MI registry, then use TRAIN=1 group for training/cross validation , and TRAIN=2 group for actual validation.
We will need to sacrifice some data in order to train our embedding. We do it simply by splitting the TRAIN=1 group into two random groups: 1A and 1B , 1A will be used in training our embedding, 1B will be used in training our model.
We will give scores at random times before the outcome (and slice with bootstrap later), say one random sample every 180 days. We will also make sure our samples have at least a BP or LDL or Glucose reading at least 3 years before the sample. This gives us the plan for the outcome training.
For the embedding training - we have lots of options, and it is not clear which is the best.
In this example we will choose the option of using the same dates and outcome times as in the outcome training group, generate a feature rich large x (source) matrix at the sample times, and a large (but smaller) destiny matrix y for the times (outcome, outcome + T) , T = 1y , which will also include our outcome variable. We will then use the embedded layer as features added to the CVD model and see if we see any improvement in perfomance.
General Vocabulary of terms we use:</p>
<ul>
<li><strong>sparse matrix</strong> : a matrix in which most values are 0 , and hence can be defined by showing only the few non-zero elements. Very efficient in holding large sets of sparse categorial features. We use the MedSparseMat class to handle these objects. Usually we create such matrices with a prefix followed by a suffix :</li>
<li><strong>.smat</strong> : the actual sparse matrix, lines of <line_number>,<column number>,<value></li>
<li><strong>.meta</strong> : containing the list of pid,time matching each line</li>
<li><strong>.dict</strong> : a dictionary giving the names of the features in each column</li>
<li><strong>.scheme</strong> : the serialized scheme file for this matrix. Allows recreating such matrices with the same rules/dictionaries on a different set of samples.</li>
<li><strong>x,y matrices</strong> - the marices we train the embedding on. The embedding will start from the (sparse) features in x[i] vector run through a network of several layers, one of which is the embedding layer, and end up in the y[i] (sparse) vector.</li>
<li><strong>embed_params</strong> : a file containing the parameters (init_from_string format) defining how to generate a sparse matrix, for example which categorial signals to use, on which sets in which time windows, etc.</li>
<li><strong>scheme file</strong> : a serialized EmbedMatCreator object (from MedEmbed.h) , containing a ready to use object that can be deserialized and used to generate sparse matrices using a predefined set of rules that was learnt.</li>
<li><strong>layers file</strong> : a file containing a keras embedding model in a format we can read and use in our infrastructure.</li>
<li><strong>outcome training</strong> : the process of training the actual model for the outcome (in this example cvd_mi)</li>
<li><strong>embedding training</strong> : the process of preparing the x,y matrices, the scheme files, train a deep learning embedding model in keras, and get the layers file. Scheme and layer files will later be used as a feature generator in the infrastructure.</li>
</ul>
<h2 id="step-2-prepare-basic-lists-and-cohort">Step 2: Prepare basic lists , and cohort</h2>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="c1"># creating a cohort file for cvd_mi : first verified mi, censoring cases with other mi&#39;s before , and cases with no BP or Glucose or LDL tests</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="w"> </span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>/nas1/UsersData/avi/MR/Projects/Shared/Embeddings/Linux/Release/Embeddings<span class="w"> </span>--build_example
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="w"> </span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="c1"># creating samples for training/testing for TRAIN=1 and TRAIN=2</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>Flow<span class="w"> </span>--rep<span class="w"> </span>/home/Repositories/THIN/thin_jun2017/thin.repository<span class="w"> </span>--cohort_fname<span class="w"> </span>./cvd_mi.cohort<span class="w"> </span>--cohort_sampling<span class="w"> </span><span class="s2">&quot;min_control=1;max_control=10;min_case=0;max_case=2;jump_days=180;train_mask=1;min_age=35;max_age=90;min_year=2004;max_year=2017;max_samples_per_id=4&quot;</span><span class="w"> </span>--out_samples<span class="w"> </span>./train_1.samples
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="w"> </span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>Flow<span class="w"> </span>--rep<span class="w"> </span>/home/Repositories/THIN/thin_jun2017/thin.repository<span class="w"> </span>--cohort_fname<span class="w"> </span>./cvd_mi.cohort<span class="w"> </span>--cohort_sampling<span class="w"> </span><span class="s2">&quot;min_control=1;max_control=10;min_case=0;max_case=2;jump_days=180;train_mask=2;min_age=35;max_age=90;min_year=2004;max_year=2017;max_samples_per_id=4&quot;</span><span class="w"> </span>--out_samples<span class="w"> </span>./train_2.samples
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="w"> </span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="w"> </span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="c1"># now filter and match on train_1 samples : making sure samples have needed information, and raising the case to control ratio in learning set</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="c1"># on the validation set we only apply the filter for needed information</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="c1"># generate validate_1 validate_2 subsets</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w"> </span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>Flow<span class="w"> </span>--rep<span class="w"> </span>/home/Repositories/THIN/thin_jun2017/thin.repository<span class="w"> </span>--filter_and_match<span class="w"> </span>--in_samples<span class="w"> </span>./train_1.samples<span class="w"> </span>--out_samples<span class="w"> </span>./validate_1.samples<span class="w"> </span>--filter_params<span class="w"> </span><span class="s2">&quot;min_sample_time=20040101;max_sample_time=20160101;bfilter=sig_name,BP,win_from,0,win_to,730,min_Nvals,1;bfilter=sig,Glucose,win_from,0,win_to,730,min_Nvals,1;bfilter=sig,LDL,win_from,0,win_to,730,min_Nvals,1;min_bfilter=1&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w"> </span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>Flow<span class="w"> </span>--rep<span class="w"> </span>/home/Repositories/THIN/thin_jun2017/thin.repository<span class="w"> </span>--filter_and_match<span class="w"> </span>--in_samples<span class="w"> </span>./train_2.samples<span class="w"> </span>--out_samples<span class="w"> </span>./validate_2.samples<span class="w"> </span>--filter_params<span class="w"> </span><span class="s2">&quot;min_sample_time=20040101;max_sample_time=20160101;bfilter=sig_name,BP,win_from,0,win_to,730,min_Nvals,1;bfilter=sig,Glucose,win_from,0,win_to,730,min_Nvals,1;bfilter=sig,LDL,win_from,0,win_to,730,min_Nvals,1;min_bfilter=1&quot;</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w"> </span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>Flow<span class="w"> </span>--rep<span class="w"> </span>/home/Repositories/THIN/thin_jun2017/thin.repository<span class="w"> </span>--filter_and_match<span class="w"> </span>--in_samples<span class="w"> </span>./validate_1.samples<span class="w"> </span>--out_samples<span class="w"> </span>./learn_1.samples<span class="w"> </span>--match_params<span class="w"> </span><span class="s2">&quot;priceRatio=200;maxRatio=10;verbose=1;strata=time,year,1&quot;</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="w"> </span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="c1"># prepare pids groupA (for embedding) and groupB (for model)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>less<span class="w"> </span>validate_1.samples<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;(NR&gt;1){print $2}&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>uniq<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $1, 1+(rand()&lt;0.5)}&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>train_pids_groups
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>less<span class="w"> </span>train_pids_groups<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;($2==1){print $1}&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>pids_group_A
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>less<span class="w"> </span>train_pids_groups<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;($2==2){print $1}&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>pids_group_B
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="c1"># prepare validate_1_A , validate_1_B , learn_1_A , learn_1_B</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>intersect.pl<span class="w"> </span>validate_1.samples<span class="w"> </span><span class="m">1</span><span class="w"> </span>pids_group_A<span class="w"> </span><span class="m">0</span><span class="w"> </span>&gt;<span class="w"> </span>validate_1_A.samples
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>intersect.pl<span class="w"> </span>validate_1.samples<span class="w"> </span><span class="m">1</span><span class="w"> </span>pids_group_B<span class="w"> </span><span class="m">0</span><span class="w"> </span>&gt;<span class="w"> </span>validate_1_B.samples
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>intersect.pl<span class="w"> </span>learn_1.samples<span class="w"> </span><span class="m">1</span><span class="w"> </span>pids_group_A<span class="w"> </span><span class="m">0</span><span class="w"> </span>&gt;<span class="w"> </span>learn_1_A.samples
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>intersect.pl<span class="w"> </span>learn_1.samples<span class="w"> </span><span class="m">1</span><span class="w"> </span>pids_group_B<span class="w"> </span><span class="m">0</span><span class="w"> </span>&gt;<span class="w"> </span>learn_1_B.samples
</code></pre></div></td></tr></table></div>
 
We now intend to use validate_1_A.samples or learn_1_A.samples to design an embedding training, and then use learn_1_B.samples to train a predictor for cvd_mi, once without embeddings signals, and once with, and compare the results (on validate_2_B in CV, and eventually on validate_2).</p>
<h2 id="step-3-design-and-prepare-the-training-dates-for-embeddings">Step 3 : Design and prepare the training dates for embeddings</h2>
<p>To train the embedding we need:
1. x matrix , at some points in time, could be random points, or points similar to how we choose validation or learning samples. We will use the pid, time of validate_1_A.samples for that (~1.6M points, ~660K patients)
2. y matrix : lots of options:</p>
<ol>
<li>take y to be x : this is exactly learning an autoencoder.</li>
<li>
<p>simply take the y time to be x time + some translation t from a set T of optional time translations:</p>
</li>
<li>
<p>T = {0} (semi-autoencoder) , T={365} (one year forward) , T={730} (two years forward) , T={-365} (one year backwards) etc... </p>
</li>
<li>T={0,365,730} , all options or random choice of one for each sample.
We will use two options: semi-autoencoder (T for y is 0), and option 2b , and randomly set the y time to be 1y or 2y ahead from the sampling point.
We keep that in a samples file where the time is the time for x and the outcomeTime is the time for y. Our code later supports this.</li>
</ol>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span>
<span class="normal"><a href="#__codelineno-1-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="c1"># preparing embedding_1_A.samples (using awk this time)</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="c1"># we could have started from learn_1_A samples, but decided to be more general and use lots of data, hence starting from validate_1_A</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="w"> </span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a>less<span class="w"> </span>validate_1_A.samples<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;(/EVENT/){print}(/SAMPLE/){a=1+(rand()&gt;0.5);a=a*10000;print &quot;SAMPLE\t&quot;$2&quot;\t&quot;$3&quot;\t&quot;$4&quot;\t&quot;$3+a&quot;\t&quot;$6}&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>embedding_1_A.samples
</code></pre></div></td></tr></table></div>
 </p>
<h2 id="step-4-prepare-the-embed_params-files-for-x-and-y">Step 4 : Prepare the embed_params files for x and y</h2>
<p>The embed_params file holds all the parameters needed in order to create a sparse matrix for an embedding.
For categorial signals we can choose the sets we are interested in (could be a very large number), and a few more settings such as time windows, if to keep as counts, if to shrink, etc.
For continous signals we can choose the ranges we are interested in.
We can also use a MedModel generated before from a json file and add the features it creates (this option is still in dev/testing)
We could use the same embed_params for x and y matrices, but to make things interesting we will use different plans for the x and y matrices.
some preparations:</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span>
<span class="normal"><a href="#__codelineno-2-2">2</a></span>
<span class="normal"><a href="#__codelineno-2-3">3</a></span>
<span class="normal"><a href="#__codelineno-2-4">4</a></span>
<span class="normal"><a href="#__codelineno-2-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="c1"># preparing the list of read codes we&#39;ll use to generate features (that&#39;s ~97K features !)</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a>less<span class="w"> </span>/home/Repositories/THIN/thin_jun2017/dict.read_codes<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;(/DEF/ &amp;&amp; substr($3,0,2)==&quot;G_&quot;){print $3}&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>rc.codes
<a id="__codelineno-2-3" name="__codelineno-2-3"></a>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="c1">### preparing the list of atc codes we&#39;ll use to generate features (~6k features)</span>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a>less<span class="w"> </span>/home/Repositories/THIN/thin_jun2017/dict.drugs_defs<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;(/DEF/ &amp;&amp; substr($3,0,4)==&quot;ATC_&quot;){print $3}&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span><span class="s2">&quot;:&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>atc.codes
</code></pre></div></td></tr></table></div>
 
x_embed_params :</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span>
<span class="normal"><a href="#__codelineno-3-12">12</a></span>
<span class="normal"><a href="#__codelineno-3-13">13</a></span>
<span class="normal"><a href="#__codelineno-3-14">14</a></span>
<span class="normal"><a href="#__codelineno-3-15">15</a></span>
<span class="normal"><a href="#__codelineno-3-16">16</a></span>
<span class="normal"><a href="#__codelineno-3-17">17</a></span>
<span class="normal"><a href="#__codelineno-3-18">18</a></span>
<span class="normal"><a href="#__codelineno-3-19">19</a></span>
<span class="normal"><a href="#__codelineno-3-20">20</a></span>
<span class="normal"><a href="#__codelineno-3-21">21</a></span>
<span class="normal"><a href="#__codelineno-3-22">22</a></span>
<span class="normal"><a href="#__codelineno-3-23">23</a></span>
<span class="normal"><a href="#__codelineno-3-24">24</a></span>
<span class="normal"><a href="#__codelineno-3-25">25</a></span>
<span class="normal"><a href="#__codelineno-3-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="na">sigs</span><span class="o">=</span><span class="s">{</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="c1"># sigs are sig=&lt;&gt; format with | between sigs</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="c1"># dummy signal is needed to make sure there&#39;s at least one entry for each line , helps in matching x,y lines</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="na">sig</span><span class="o">=</span><span class="s">dummy</span><span class="c1">;type=dummy|</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="c1"># age category with a binning to 10 groups</span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="na">sig</span><span class="o">=</span><span class="s">BYEAR</span><span class="c1">;type=age;ranges=0,10,20,30,40,50,60,70,80,90,1000;do_shrink=0|</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="c1"># gender with 2 categories</span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="na">sig</span><span class="o">=</span><span class="s">GENDER</span><span class="c1">;type=continuous;ranges=1,2,3;do_shrink=0|</span>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="c1"># RC signals : categorial , use rc.codes list as categories, look at a large (ever) time window, use hierarchy and count each category used</span>
<a id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="na">sig</span><span class="o">=</span><span class="s">RC</span><span class="c1">;type=categorial;categories=list:rc.codes;win_from=0;win_to=36500;add_hierarchy=1;do_counts=1|</span>
<a id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="c1"># RC signals : categorial same as previous but for a short (1y) time window</span>
<a id="__codelineno-3-12" name="__codelineno-3-12"></a><span class="na">sig</span><span class="o">=</span><span class="s">RC</span><span class="c1">;type=categorial;categories=list:rc.codes;win_from=0;win_to=365;add_hierarchy=1;do_counts=1|</span>
<a id="__codelineno-3-13" name="__codelineno-3-13"></a><span class="c1"># Drug signals , last 2 years</span>
<a id="__codelineno-3-14" name="__codelineno-3-14"></a><span class="na">sig</span><span class="o">=</span><span class="s">Drug</span><span class="c1">;type=categorial;categories=list:atc.codes;win_from=0;win_to=730;add_hierarchy=1;do_counts=1|</span>
<a id="__codelineno-3-15" name="__codelineno-3-15"></a><span class="c1"># Adding LDL distribution to bins in last 5 years</span>
<a id="__codelineno-3-16" name="__codelineno-3-16"></a><span class="na">sig</span><span class="o">=</span><span class="s">LDL</span><span class="c1">;type=continuous;ranges=0,50,70,100,120,150,200,300,10000;do_shrink=0;win_from=0;win_to=1800;do_counts=1|</span>
<a id="__codelineno-3-17" name="__codelineno-3-17"></a><span class="c1"># Adding Glucose distribution to bins in last 5 years</span>
<a id="__codelineno-3-18" name="__codelineno-3-18"></a><span class="na">sig</span><span class="o">=</span><span class="s">Glucose</span><span class="c1">;type=continuous;ranges=0,50,70,90,100,110,125,150,200,10000;do_shrink=0;win_from=0;win_to=1800;do_counts=1|</span>
<a id="__codelineno-3-19" name="__codelineno-3-19"></a><span class="c1"># Adding HbA1C distribution to bins in last 5 years</span>
<a id="__codelineno-3-20" name="__codelineno-3-20"></a><span class="na">sig</span><span class="o">=</span><span class="s">HbA1C</span><span class="c1">;type=continuous;ranges=0,4.0,5.0,5.7,6.0,6.5,7.0,8.0,10.0,10000;do_shrink=0;win_from=0;win_to=1800|</span>
<a id="__codelineno-3-21" name="__codelineno-3-21"></a><span class="c1"># Adding Cretinine distribution to bins in last 5 years</span>
<a id="__codelineno-3-22" name="__codelineno-3-22"></a><span class="na">sig</span><span class="o">=</span><span class="s">Creatinine</span><span class="c1">;type=continuous;ranges=0,0.5,0.8,1.0,1.2,1.5,2.0,3.0,4.0,10000;do_shrink=0;win_from=0;win_to=1800|</span>
<a id="__codelineno-3-23" name="__codelineno-3-23"></a><span class="c1"># Adding BP distribution to bins in last 5 years</span>
<a id="__codelineno-3-24" name="__codelineno-3-24"></a><span class="na">sig</span><span class="o">=</span><span class="s">BP</span><span class="c1">;type=continuous;val_chan=0;ranges=0,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,10000;do_shrink=0;win_from=0;win_to=1800|</span>
<a id="__codelineno-3-25" name="__codelineno-3-25"></a><span class="na">sig</span><span class="o">=</span><span class="s">BP</span><span class="c1">;type=continuous;val_chan=1;ranges=0,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,10000;do_shrink=0;win_from=0;win_to=1800</span>
<a id="__codelineno-3-26" name="__codelineno-3-26"></a><span class="na">};</span>
</code></pre></div></td></tr></table></div>
 
y_embed params: preferring do_counts=0 as easier to build loss function for.
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span>
<span class="normal"><a href="#__codelineno-4-23">23</a></span>
<span class="normal"><a href="#__codelineno-4-24">24</a></span>
<span class="normal"><a href="#__codelineno-4-25">25</a></span>
<span class="normal"><a href="#__codelineno-4-26">26</a></span>
<span class="normal"><a href="#__codelineno-4-27">27</a></span>
<span class="normal"><a href="#__codelineno-4-28">28</a></span>
<span class="normal"><a href="#__codelineno-4-29">29</a></span>
<span class="normal"><a href="#__codelineno-4-30">30</a></span>
<span class="normal"><a href="#__codelineno-4-31">31</a></span>
<span class="normal"><a href="#__codelineno-4-32">32</a></span>
<span class="normal"><a href="#__codelineno-4-33">33</a></span>
<span class="normal"><a href="#__codelineno-4-34">34</a></span>
<span class="normal"><a href="#__codelineno-4-35">35</a></span>
<span class="normal"><a href="#__codelineno-4-36">36</a></span>
<span class="normal"><a href="#__codelineno-4-37">37</a></span>
<span class="normal"><a href="#__codelineno-4-38">38</a></span>
<span class="normal"><a href="#__codelineno-4-39">39</a></span>
<span class="normal"><a href="#__codelineno-4-40">40</a></span>
<span class="normal"><a href="#__codelineno-4-41">41</a></span>
<span class="normal"><a href="#__codelineno-4-42">42</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="na">sigs</span><span class="o">=</span><span class="s">{</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="c1"># sigs are sig=&lt;&gt; format with | between sigs</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="c1"># dummy signal is needed to make sure there&#39;s at least one entry for each line , helps in matching x,y lines</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="na">sig</span><span class="o">=</span><span class="s">dummy</span><span class="c1">;type=dummy|</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="c1"># age category with a binning to 10 groups</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="na">sig</span><span class="o">=</span><span class="s">BYEAR</span><span class="c1">;type=age;ranges=0,10,20,30,40,50,60,70,80,90,1000;do_shrink=0|</span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="c1"># gender with 2 categories</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="na">sig</span><span class="o">=</span><span class="s">GENDER</span><span class="c1">;type=continuous;ranges=1,2,3;do_shrink=0|</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="c1"># RC signals : categorial same as previous but for a short (1y) time window</span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="na">sig</span><span class="o">=</span><span class="s">RC</span><span class="c1">;type=categorial;categories=list:rc.codes;win_from=0;win_to=365;add_hierarchy=1;do_counts=0|</span>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="c1"># Drug signals , last 2 years</span>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="na">sig</span><span class="o">=</span><span class="s">Drug</span><span class="c1">;type=categorial;categories=list:atc.codes;win_from=0;win_to=365;add_hierarchy=1;do_counts=0|</span>
<a id="__codelineno-4-13" name="__codelineno-4-13"></a><span class="c1"># Adding LDL distribution to bins in last year</span>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a><span class="na">sig</span><span class="o">=</span><span class="s">LDL</span><span class="c1">;type=continuous;ranges=0,50,70,100,120,150,200,300,10000;do_shrink=0;win_from=0;win_to=365;do_counts=0|</span>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a><span class="c1"># Adding Glucose distribution to bins in last year</span>
<a id="__codelineno-4-16" name="__codelineno-4-16"></a><span class="na">sig</span><span class="o">=</span><span class="s">Glucose</span><span class="c1">;type=continuous;ranges=0,50,70,90,100,110,125,150,200,10000;do_shrink=0;win_from=0;win_to=365;do_counts=0|</span>
<a id="__codelineno-4-17" name="__codelineno-4-17"></a><span class="c1"># Adding HbA1C distribution to bins in last year</span>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a><span class="na">sig</span><span class="o">=</span><span class="s">HbA1C</span><span class="c1">;type=continuous;ranges=0,4.0,5.0,5.7,6.0,6.5,7.0,8.0,10.0,10000;do_shrink=0;win_from=0;win_to=365;do_counts=0|</span>
<a id="__codelineno-4-19" name="__codelineno-4-19"></a><span class="c1"># Adding Past/Future Registries: past, 1y ahead, 5y ahead</span>
<a id="__codelineno-4-20" name="__codelineno-4-20"></a><span class="c1"># In y matrices it is perfectly OK to peek into the future (!) we only use them for training</span>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a><span class="na">sig</span><span class="o">=</span><span class="s">CVD_MI</span><span class="c1">;type=categorial;categories=CVD_MI_Confirmed_Event,CVD_MI_Untimed_Event,CVD_MI_History;win_from=0;win_to=10000;do_counts=0;do_shrink=0|</span>
<a id="__codelineno-4-22" name="__codelineno-4-22"></a><span class="na">sig</span><span class="o">=</span><span class="s">CVD_MI</span><span class="c1">;type=categorial;categories=CVD_MI_Confirmed_Event,CVD_MI_Untimed_Event,CVD_MI_History;win_from=-365;win_to=0;do_counts=0;do_shrink=0|</span>
<a id="__codelineno-4-23" name="__codelineno-4-23"></a><span class="na">sig</span><span class="o">=</span><span class="s">CVD_MI</span><span class="c1">;type=categorial;categories=CVD_MI_Confirmed_Event,CVD_MI_Untimed_Event,CVD_MI_History;win_from=-1825;win_to=0;do_counts=0;do_shrink=0|</span>
<a id="__codelineno-4-24" name="__codelineno-4-24"></a><span class="na">sig</span><span class="o">=</span><span class="s">CVD_IschemicStroke</span><span class="c1">;type=categorial;categories=CVD_IschemicStroke_Confirmed_Event,CVD_IschemicStroke_Untimed_Event,CVD_IschemicStroke_History;win_from=0;win_to=10000;do_counts=0;do_shrink=0|</span>
<a id="__codelineno-4-25" name="__codelineno-4-25"></a><span class="na">sig</span><span class="o">=</span><span class="s">CVD_IschemicStroke</span><span class="c1">;type=categorial;categories=CVD_IschemicStroke_Confirmed_Event,CVD_IschemicStroke_Untimed_Event,CVD_IschemicStroke_History;win_from=-365;win_to=0;do_counts=0;do_shrink=0|</span>
<a id="__codelineno-4-26" name="__codelineno-4-26"></a><span class="na">sig</span><span class="o">=</span><span class="s">CVD_IschemicStroke</span><span class="c1">;type=categorial;categories=CVD_IschemicStroke_Confirmed_Event,CVD_IschemicStroke_Untimed_Event,CVD_IschemicStroke_History;win_from=-1825;win_to=0;do_counts=0;do_shrink=0|</span>
<a id="__codelineno-4-27" name="__codelineno-4-27"></a><span class="na">sig</span><span class="o">=</span><span class="s">CVD_HemorhagicStroke</span><span class="c1">;type=categorial;categories=CVD_HemorhagicStroke_Confirmed_Event,CVD_HemorhagicStroke_Untimed_Event,CVD_HemorhagicStroke_History;win_from=0;win_to=0;do_counts=10000;do_shrink=0|</span>
<a id="__codelineno-4-28" name="__codelineno-4-28"></a><span class="na">sig</span><span class="o">=</span><span class="s">CVD_HemorhagicStroke</span><span class="c1">;type=categorial;categories=CVD_HemorhagicStroke_Confirmed_Event,CVD_HemorhagicStroke_Untimed_Event,CVD_HemorhagicStroke_History;win_from=-365;win_to=0;do_counts=0;do_shrink=0|</span>
<a id="__codelineno-4-29" name="__codelineno-4-29"></a><span class="na">sig</span><span class="o">=</span><span class="s">CVD_HemorhagicStroke</span><span class="c1">;type=categorial;categories=CVD_HemorhagicStroke_Confirmed_Event,CVD_HemorhagicStroke_Untimed_Event,CVD_HemorhagicStroke_History;win_from=-1825;win_to=0;do_counts=0;do_shrink=0|</span>
<a id="__codelineno-4-30" name="__codelineno-4-30"></a><span class="na">sig</span><span class="o">=</span><span class="s">CVD_HeartFailure</span><span class="c1">;type=categorial;categories=CVD_HeartFailure_First_Indication;win_from=0;win_to=10000;do_counts=0;do_shrink=0|</span>
<a id="__codelineno-4-31" name="__codelineno-4-31"></a><span class="na">sig</span><span class="o">=</span><span class="s">CVD_HeartFailure</span><span class="c1">;type=categorial;categories=CVD_HeartFailure_First_Indication;win_from=-365;win_to=0;do_counts=0;do_shrink=0|</span>
<a id="__codelineno-4-32" name="__codelineno-4-32"></a><span class="na">sig</span><span class="o">=</span><span class="s">CVD_HeartFailure</span><span class="c1">;type=categorial;categories=CVD_HeartFailure_First_Indication;win_from=-1825;win_to=0;do_counts=0;do_shrink=0|</span>
<a id="__codelineno-4-33" name="__codelineno-4-33"></a><span class="na">sig</span><span class="o">=</span><span class="s">CKD_State</span><span class="c1">;type=categorial;categories=CKD_State_Normal,CKD_State_Level_1,CKD_State_Level_2,CKD_State_Level_3,CKD_State_Level_4;win_from=0;win_to=10000;do_counts=0;do_shrink=0|</span>
<a id="__codelineno-4-34" name="__codelineno-4-34"></a><span class="na">sig</span><span class="o">=</span><span class="s">CKD_State</span><span class="c1">;type=categorial;categories=CKD_State_Normal,CKD_State_Level_1,CKD_State_Level_2,CKD_State_Level_3,CKD_State_Level_4;win_from=-365;win_to=0;do_counts=0;do_shrink=0|</span>
<a id="__codelineno-4-35" name="__codelineno-4-35"></a><span class="na">sig</span><span class="o">=</span><span class="s">CKD_State</span><span class="c1">;type=categorial;categories=CKD_State_Normal,CKD_State_Level_1,CKD_State_Level_2,CKD_State_Level_3,CKD_State_Level_4;win_from=-1825;win_to=0;do_counts=0;do_shrink=0|</span>
<a id="__codelineno-4-36" name="__codelineno-4-36"></a><span class="na">sig</span><span class="o">=</span><span class="s">DM_Registry</span><span class="c1">;type=categorial;categories=DM_Registry_Pre_diabetic,DM_Registry_Diabetic;win_from=0;win_to=10000;do_counts=0;do_shrink=0|</span>
<a id="__codelineno-4-37" name="__codelineno-4-37"></a><span class="na">sig</span><span class="o">=</span><span class="s">DM_Registry</span><span class="c1">;type=categorial;categories=DM_Registry_Pre_diabetic,DM_Registry_Diabetic;win_from=-365;win_to=0;do_counts=0;do_shrink=0|</span>
<a id="__codelineno-4-38" name="__codelineno-4-38"></a><span class="na">sig</span><span class="o">=</span><span class="s">DM_Registry</span><span class="c1">;type=categorial;categories=DM_Registry_Pre_diabetic,DM_Registry_Diabetic;win_from=-1825;win_to=0;do_counts=0;do_shrink=0|</span>
<a id="__codelineno-4-39" name="__codelineno-4-39"></a><span class="na">sig</span><span class="o">=</span><span class="s">HT_Registry</span><span class="c1">;type=categorial;categories=HT_Registry_Hypertensive;win_from=0;win_to=10000;do_counts=0;do_shrink=0|</span>
<a id="__codelineno-4-40" name="__codelineno-4-40"></a><span class="na">sig</span><span class="o">=</span><span class="s">HT_Registry</span><span class="c1">;type=categorial;categories=HT_Registry_Hypertensive;win_from=-365;win_to=0;do_counts=0;do_shrink=0|</span>
<a id="__codelineno-4-41" name="__codelineno-4-41"></a><span class="na">sig</span><span class="o">=</span><span class="s">HT_Registry</span><span class="c1">;type=categorial;categories=HT_Registry_Hypertensive;win_from=-1825;win_to=0;do_counts=0;do_shrink=0</span>
<a id="__codelineno-4-42" name="__codelineno-4-42"></a><span class="na">};</span>
</code></pre></div></td></tr></table></div>
 </p>
<h2 id="step-5-create-the-x-and-y-matrices">Step 5: Create the x and y matrices</h2>
<p>Finally we are ready for this stage. We will start with our samples file, and create 2 matrices from it, the x will use time, the y will use outcomeTime. The matrices will use the embed rules we defined in the previous step, and we will also shrink them to only contain values that appear at least 1e-3 of the samples (to have roughly at least ~1000 cases of it appearing), and less than 0.75 of the samples , to screen to frequent or too rare columns.
Our samples file is the one we prepared before: embedding_1_A.samples (1.6M training points)
To actually create the matrices we use the Embeddings project, with the --gen_mat option.</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="c1"># command line to create x matrix</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a>Embeddings<span class="w"> </span>--gen_mat<span class="w"> </span>--rep<span class="w"> </span>&lt;rep&gt;<span class="w"> </span>--f_samples<span class="w"> </span>./embedding_1_A.samples<span class="w"> </span>--embed<span class="w"> </span><span class="s2">&quot;pFile=x_embed_params&quot;</span><span class="w"> </span>--min_p<span class="w"> </span><span class="m">0</span>.001<span class="w"> </span>--max_p<span class="w"> </span><span class="m">0</span>.75<span class="w"> </span>--prefix<span class="w"> </span>x
</code></pre></div></td></tr></table></div>
 </p>
<h3 id="files-created-ls-l">files created (ls -l) :</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span>
<span class="normal"><a href="#__codelineno-6-3">3</a></span>
<span class="normal"><a href="#__codelineno-6-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a>-rwxrwxrwx 1 root root 6521109879 Feb 13 17:58 x.smat           &lt;---- the sparse matrix. And yes, that is a 6.5GB matrix....
<a id="__codelineno-6-2" name="__codelineno-6-2"></a>-rwxrwxrwx 1 root root   40597062 Feb 13 18:00 x.meta           &lt;---- pid,time for each line (same number of lines as in our samples file)
<a id="__codelineno-6-3" name="__codelineno-6-3"></a>-rwxrwxrwx 1 root root    1892057 Feb 13 18:00 x.scheme         &lt;---- our serialized x scheme file for this matrix : we will need it when we later create features within a model !
<a id="__codelineno-6-4" name="__codelineno-6-4"></a>-rwxrwxrwx 1 root root    1256521 Feb 13 18:00 x.dict           &lt;---- the names of all the columns in the shrunk matrix
</code></pre></div></td></tr></table></div>
<h3 id="and-now-creating-the-y-matrix">and now creating the y matrix</h3>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a>Embeddings<span class="w"> </span>--gen_mat<span class="w"> </span>--rep<span class="w"> </span>&lt;rep&gt;<span class="w"> </span>--f_samples<span class="w"> </span>./embedding_1_A.samples<span class="w"> </span>--embed<span class="w"> </span><span class="s2">&quot;pFile=./y_embed_params&quot;</span><span class="w"> </span>--min_p<span class="w"> </span><span class="m">0</span>.001<span class="w"> </span>--max_p<span class="w"> </span><span class="m">0</span>.75<span class="w"> </span>--prefix<span class="w"> </span>y
</code></pre></div></td></tr></table></div>
 </p>
<h2 id="step-6-train-the-embedding-using-keras">Step 6: Train the embedding using Keras</h2>
<p>We are now at a state in which we have our x &amp; y matrices ready. Our goal now is to calculate a deep learning model starting from x[i] and ending in y[i], while flowing through a narrow layer with few (say 100-200) neurons. 
To do that use the Embedder.py script, or copy it and change what you need inside. The Embedder.py script allows the following:</p>
<ol>
<li>Train through 3 layers (last is the embedding) </li>
<li>Train through 5 simetric layers with the middle as the embedding layer.</li>
<li>
<p>Control parameters of network:</p>
</li>
<li>
<p>layers sizes</p>
</li>
<li>
<p>l1, l2, dropout regularizers on each layer</p>
</li>
<li>control of extra weight given to cases in the loss function</li>
<li>control leaky ReLU function parameters</li>
<li>control noise added to embedding layer in training</li>
<li>control number of epochs in training, also allow to continue training of a saved model.</li>
<li>savind model in a way that can be later used in the infrastructure (.layers file)</li>
<li>test modes to generate predictions/embedding layer results on a set of examples (to allow testing vs. the infrastructure)
The Embedder.py script is in the git in .../MR/Projects/Shared/Embeddings/scripts/
 
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">  1</a></span>
<span class="normal"><a href="#__codelineno-8-2">  2</a></span>
<span class="normal"><a href="#__codelineno-8-3">  3</a></span>
<span class="normal"><a href="#__codelineno-8-4">  4</a></span>
<span class="normal"><a href="#__codelineno-8-5">  5</a></span>
<span class="normal"><a href="#__codelineno-8-6">  6</a></span>
<span class="normal"><a href="#__codelineno-8-7">  7</a></span>
<span class="normal"><a href="#__codelineno-8-8">  8</a></span>
<span class="normal"><a href="#__codelineno-8-9">  9</a></span>
<span class="normal"><a href="#__codelineno-8-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-8-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-8-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-8-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-8-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-8-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-8-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-8-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-8-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-8-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-8-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-8-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-8-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-8-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-8-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-8-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-8-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-8-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-8-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-8-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-8-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-8-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-8-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-8-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-8-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-8-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-8-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-8-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-8-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-8-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-8-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-8-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-8-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-8-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-8-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-8-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-8-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-8-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-8-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-8-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-8-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-8-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-8-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-8-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-8-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-8-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-8-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-8-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-8-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-8-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-8-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-8-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-8-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-8-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-8-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-8-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-8-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-8-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-8-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-8-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-8-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-8-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-8-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-8-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-8-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-8-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-8-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-8-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-8-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-8-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-8-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-8-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-8-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-8-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-8-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-8-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-8-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-8-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-8-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-8-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-8-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-8-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-8-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-8-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-8-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-8-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-8-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-8-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-8-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-8-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-8-100">100</a></span>
<span class="normal"><a href="#__codelineno-8-101">101</a></span>
<span class="normal"><a href="#__codelineno-8-102">102</a></span>
<span class="normal"><a href="#__codelineno-8-103">103</a></span>
<span class="normal"><a href="#__codelineno-8-104">104</a></span>
<span class="normal"><a href="#__codelineno-8-105">105</a></span>
<span class="normal"><a href="#__codelineno-8-106">106</a></span>
<span class="normal"><a href="#__codelineno-8-107">107</a></span>
<span class="normal"><a href="#__codelineno-8-108">108</a></span>
<span class="normal"><a href="#__codelineno-8-109">109</a></span>
<span class="normal"><a href="#__codelineno-8-110">110</a></span>
<span class="normal"><a href="#__codelineno-8-111">111</a></span>
<span class="normal"><a href="#__codelineno-8-112">112</a></span>
<span class="normal"><a href="#__codelineno-8-113">113</a></span>
<span class="normal"><a href="#__codelineno-8-114">114</a></span>
<span class="normal"><a href="#__codelineno-8-115">115</a></span>
<span class="normal"><a href="#__codelineno-8-116">116</a></span>
<span class="normal"><a href="#__codelineno-8-117">117</a></span>
<span class="normal"><a href="#__codelineno-8-118">118</a></span>
<span class="normal"><a href="#__codelineno-8-119">119</a></span>
<span class="normal"><a href="#__codelineno-8-120">120</a></span>
<span class="normal"><a href="#__codelineno-8-121">121</a></span>
<span class="normal"><a href="#__codelineno-8-122">122</a></span>
<span class="normal"><a href="#__codelineno-8-123">123</a></span>
<span class="normal"><a href="#__codelineno-8-124">124</a></span>
<span class="normal"><a href="#__codelineno-8-125">125</a></span>
<span class="normal"><a href="#__codelineno-8-126">126</a></span>
<span class="normal"><a href="#__codelineno-8-127">127</a></span>
<span class="normal"><a href="#__codelineno-8-128">128</a></span>
<span class="normal"><a href="#__codelineno-8-129">129</a></span>
<span class="normal"><a href="#__codelineno-8-130">130</a></span>
<span class="normal"><a href="#__codelineno-8-131">131</a></span>
<span class="normal"><a href="#__codelineno-8-132">132</a></span>
<span class="normal"><a href="#__codelineno-8-133">133</a></span>
<span class="normal"><a href="#__codelineno-8-134">134</a></span>
<span class="normal"><a href="#__codelineno-8-135">135</a></span>
<span class="normal"><a href="#__codelineno-8-136">136</a></span>
<span class="normal"><a href="#__codelineno-8-137">137</a></span>
<span class="normal"><a href="#__codelineno-8-138">138</a></span>
<span class="normal"><a href="#__codelineno-8-139">139</a></span>
<span class="normal"><a href="#__codelineno-8-140">140</a></span>
<span class="normal"><a href="#__codelineno-8-141">141</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="c1"># example run training a model</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a>python<span class="w"> </span>./Embedder.py<span class="w"> </span>--xfile<span class="w"> </span>./x.smat<span class="w"> </span>--yfile<span class="w"> </span>./y.smat<span class="w"> </span>--nepochs<span class="w"> </span><span class="m">5</span><span class="w"> </span>--dim<span class="w"> </span><span class="m">400</span><span class="w"> </span><span class="m">200</span><span class="w"> </span><span class="m">100</span><span class="w"> </span>--l1<span class="w"> </span>1e-7<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>--out_model<span class="w"> </span>emodel<span class="w"> </span>--train<span class="w"> </span>--wgt<span class="w"> </span><span class="m">10</span><span class="w"> </span>--dropout<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span>--noise<span class="w"> </span><span class="m">0</span>.3<span class="w"> </span>--gpu<span class="w"> </span><span class="m">1</span><span class="w"> </span>--full_decode
<a id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="w"> </span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="c1"># output explained ... : (# lines added to explain)</span>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a>Using<span class="w"> </span>TensorFlow<span class="w"> </span>backend.
<a id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="c1"># full parameter list</span>
<a id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="o">(</span><span class="s1">&#39;arguments----&gt;&#39;</span>,<span class="w"> </span>Namespace<span class="o">(</span><span class="nv">dim</span><span class="o">=[</span><span class="m">400</span>,<span class="w"> </span><span class="m">200</span>,<span class="w"> </span><span class="m">100</span><span class="o">]</span>,<span class="w"> </span><span class="nv">dropout</span><span class="o">=[</span><span class="m">0</span>.0,<span class="w"> </span><span class="m">0</span>.0,<span class="w"> </span><span class="m">0</span>.0<span class="o">]</span>,<span class="w"> </span><span class="nv">embed</span><span class="o">=</span>False,<span class="w"> </span><span class="nv">full_decode</span><span class="o">=</span>True,<span class="w"> </span><span class="nv">gpu</span><span class="o">=[</span><span class="m">1</span><span class="o">]</span>,<span class="w"> </span><span class="nv">in_model</span><span class="o">=</span><span class="s1">&#39;&#39;</span>,<span class="w"> </span><span class="nv">l1</span><span class="o">=[</span>1e-07,<span class="w"> </span><span class="m">0</span>.0,<span class="w"> </span><span class="m">0</span>.0<span class="o">]</span>,<span class="w"> </span><span class="nv">l2</span><span class="o">=[</span><span class="m">0</span>.0,<span class="w"> </span><span class="m">0</span>.0,<span class="w"> </span><span class="m">0</span>.0<span class="o">]</span>,<span class="w"> </span><span class="nv">leaky</span><span class="o">=[</span><span class="m">0</span>.1<span class="o">]</span>,<span class="w"> </span><span class="nv">nepochs</span><span class="o">=[</span><span class="m">5</span><span class="o">]</span>,<span class="w"> </span><span class="nv">no_shuffle</span><span class="o">=</span>False,<span class="w"> </span><span class="nv">noise</span><span class="o">=[</span><span class="m">0</span>.3<span class="o">]</span>,<span class="w"> </span><span class="nv">out_model</span><span class="o">=[</span><span class="s1">&#39;emodel&#39;</span><span class="o">]</span>,<span class="w"> </span><span class="nv">test</span><span class="o">=</span>False,<span class="w"> </span><span class="nv">train</span><span class="o">=</span>True,<span class="w"> </span><span class="nv">wgt</span><span class="o">=[</span><span class="m">10</span>.0<span class="o">]</span>,<span class="w"> </span><span class="nv">xdim</span><span class="o">=</span>-1,<span class="w"> </span><span class="nv">xfile</span><span class="o">=[</span><span class="s1">&#39;./x.smat&#39;</span><span class="o">]</span>,<span class="w"> </span><span class="nv">ydim</span><span class="o">=</span>-1,<span class="w"> </span><span class="nv">yfile</span><span class="o">=[</span><span class="s1">&#39;./y.smat&#39;</span><span class="o">]))</span>
<a id="__codelineno-8-8" name="__codelineno-8-8"></a><span class="c1"># using only gpu 1 , not setting this will allow running on all gpus in parallel, or on another (say gpu 0)</span>
<a id="__codelineno-8-9" name="__codelineno-8-9"></a>using<span class="w"> </span>gpu<span class="w">  </span><span class="m">1</span>
<a id="__codelineno-8-10" name="__codelineno-8-10"></a>Train<span class="w"> </span>mode
<a id="__codelineno-8-11" name="__codelineno-8-11"></a><span class="c1"># reading input matrices (can be quite slow, as matrices can be huge)</span>
<a id="__codelineno-8-12" name="__codelineno-8-12"></a><span class="o">(</span><span class="s1">&#39;reading: &#39;</span>,<span class="w"> </span><span class="o">[</span><span class="s1">&#39;./x.smat&#39;</span><span class="o">]</span>,<span class="w"> </span><span class="o">[</span><span class="s1">&#39;./y.smat&#39;</span><span class="o">])</span>
<a id="__codelineno-8-13" name="__codelineno-8-13"></a>reading<span class="w"> </span>csv<span class="w"> </span>file:<span class="w">  </span>./x.smat<span class="w"> </span><span class="m">13</span>:11:18.800850
<a id="__codelineno-8-14" name="__codelineno-8-14"></a>preparing<span class="w"> </span>sparse<span class="w"> </span>mat<span class="w"> </span><span class="m">13</span>:14:27.758752
<a id="__codelineno-8-15" name="__codelineno-8-15"></a>reading<span class="w"> </span>csv<span class="w"> </span>file:<span class="w">  </span>./y.smat<span class="w"> </span><span class="m">13</span>:14:40.032091
<a id="__codelineno-8-16" name="__codelineno-8-16"></a>preparing<span class="w"> </span>sparse<span class="w"> </span>mat<span class="w"> </span><span class="m">13</span>:15:34.727952
<a id="__codelineno-8-17" name="__codelineno-8-17"></a><span class="c1"># printing some basic info on sparse matrices x,y : note for example the ratio of 0 to non 0 in x is 43.1 and in y 48.08 (!), showing how sparse they are.</span>
<a id="__codelineno-8-18" name="__codelineno-8-18"></a><span class="o">(</span><span class="s1">&#39;xtrain : &#39;</span>,<span class="w"> </span><span class="o">(</span><span class="m">1623366</span>,<span class="w"> </span><span class="m">11933</span><span class="o">)</span>,<span class="w"> </span>&lt;1623366x11933<span class="w"> </span>sparse<span class="w"> </span>matrix<span class="w"> </span>of<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;&lt;type &#39;</span>numpy.float32<span class="s1">&#39;&gt;&#39;</span>
<a id="__codelineno-8-19" name="__codelineno-8-19"></a><span class="w">        </span>with<span class="w"> </span><span class="m">451035611</span><span class="w"> </span>stored<span class="w"> </span>elements<span class="w"> </span><span class="k">in</span><span class="w"> </span>Compressed<span class="w"> </span>Sparse<span class="w"> </span>Row<span class="w"> </span>format&gt;,<span class="w"> </span><span class="s1">&#39;non zero: &#39;</span>,<span class="w"> </span><span class="m">449412245</span>,<span class="w"> </span><span class="m">43</span>.10435840038137<span class="o">)</span>
<a id="__codelineno-8-20" name="__codelineno-8-20"></a><span class="o">(</span><span class="s1">&#39;ytrain : &#39;</span>,<span class="w"> </span><span class="o">(</span><span class="m">1623366</span>,<span class="w"> </span><span class="m">3986</span><span class="o">)</span>,<span class="w"> </span>&lt;1623366x3986<span class="w"> </span>sparse<span class="w"> </span>matrix<span class="w"> </span>of<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s1">&#39;&lt;type &#39;</span>numpy.float32<span class="s1">&#39;&gt;&#39;</span>
<a id="__codelineno-8-21" name="__codelineno-8-21"></a><span class="w">        </span>with<span class="w"> </span><span class="m">136188699</span><span class="w"> </span>stored<span class="w"> </span>elements<span class="w"> </span><span class="k">in</span><span class="w"> </span>Compressed<span class="w"> </span>Sparse<span class="w"> </span>Row<span class="w"> </span>format&gt;,<span class="w"> </span><span class="s1">&#39; non zero: &#39;</span>,<span class="w"> </span><span class="m">134565333</span>,<span class="w"> </span><span class="m">48</span>.08621010881012<span class="o">)</span>
<a id="__codelineno-8-22" name="__codelineno-8-22"></a><span class="o">(</span><span class="s1">&#39;ORIGDIM----&gt; &#39;</span>,<span class="w"> </span><span class="m">11933</span>,<span class="w"> </span><span class="m">3986</span>,<span class="w"> </span>-1,<span class="w"> </span>-1<span class="o">)</span>
<a id="__codelineno-8-23" name="__codelineno-8-23"></a><span class="c1"># and now the actual training results</span>
<a id="__codelineno-8-24" name="__codelineno-8-24"></a>Running<span class="w"> </span>model<span class="w"> </span>definition
<a id="__codelineno-8-25" name="__codelineno-8-25"></a><span class="m">10</span>.0
<a id="__codelineno-8-26" name="__codelineno-8-26"></a><span class="m">10</span>.0
<a id="__codelineno-8-27" name="__codelineno-8-27"></a>Training<span class="w"> </span>on<span class="w"> </span>xtrain
<a id="__codelineno-8-28" name="__codelineno-8-28"></a>Train<span class="w"> </span>on<span class="w"> </span><span class="m">1298692</span><span class="w"> </span>samples,<span class="w"> </span>validate<span class="w"> </span>on<span class="w"> </span><span class="m">324674</span><span class="w"> </span>samples
<a id="__codelineno-8-29" name="__codelineno-8-29"></a>Epoch<span class="w"> </span><span class="m">1</span>/5
<a id="__codelineno-8-30" name="__codelineno-8-30"></a><span class="m">2019</span>-02-20<span class="w"> </span><span class="m">13</span>:15:51.200332:<span class="w"> </span>I<span class="w"> </span>tensorflow/core/platform/cpu_feature_guard.cc:140<span class="o">]</span><span class="w"> </span>Your<span class="w"> </span>CPU<span class="w"> </span>supports<span class="w"> </span>instructions<span class="w"> </span>that<span class="w"> </span>this<span class="w"> </span>TensorFlow<span class="w"> </span>binary<span class="w"> </span>was<span class="w"> </span>not<span class="w"> </span>compiled<span class="w"> </span>to<span class="w"> </span>use:<span class="w"> </span>AVX2<span class="w"> </span>FMA
<a id="__codelineno-8-31" name="__codelineno-8-31"></a><span class="m">2019</span>-02-20<span class="w"> </span><span class="m">13</span>:15:52.226714:<span class="w"> </span>I<span class="w"> </span>tensorflow/core/common_runtime/gpu/gpu_device.cc:1212<span class="o">]</span><span class="w"> </span>Found<span class="w"> </span>device<span class="w"> </span><span class="m">0</span><span class="w"> </span>with<span class="w"> </span>properties:
<a id="__codelineno-8-32" name="__codelineno-8-32"></a>name:<span class="w"> </span>GeForce<span class="w"> </span>GTX<span class="w"> </span><span class="m">1080</span><span class="w"> </span>Ti<span class="w"> </span>major:<span class="w"> </span><span class="m">6</span><span class="w"> </span>minor:<span class="w"> </span><span class="m">1</span><span class="w"> </span>memoryClockRate<span class="o">(</span>GHz<span class="o">)</span>:<span class="w"> </span><span class="m">1</span>.582
<a id="__codelineno-8-33" name="__codelineno-8-33"></a>pciBusID:<span class="w"> </span><span class="m">0000</span>:81:00.0
<a id="__codelineno-8-34" name="__codelineno-8-34"></a>totalMemory:<span class="w"> </span><span class="m">10</span>.92GiB<span class="w"> </span>freeMemory:<span class="w"> </span><span class="m">10</span>.76GiB
<a id="__codelineno-8-35" name="__codelineno-8-35"></a><span class="m">2019</span>-02-20<span class="w"> </span><span class="m">13</span>:15:52.226779:<span class="w"> </span>I<span class="w"> </span>tensorflow/core/common_runtime/gpu/gpu_device.cc:1312<span class="o">]</span><span class="w"> </span>Adding<span class="w"> </span>visible<span class="w"> </span>gpu<span class="w"> </span>devices:<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-8-36" name="__codelineno-8-36"></a><span class="m">2019</span>-02-20<span class="w"> </span><span class="m">13</span>:15:52.504954:<span class="w"> </span>I<span class="w"> </span>tensorflow/core/common_runtime/gpu/gpu_device.cc:993<span class="o">]</span><span class="w"> </span>Creating<span class="w"> </span>TensorFlow<span class="w"> </span>device<span class="w"> </span><span class="o">(</span>/job:localhost/replica:0/task:0/device:GPU:0<span class="w"> </span>with<span class="w"> </span><span class="m">10415</span><span class="w"> </span>MB<span class="w"> </span>memory<span class="o">)</span><span class="w"> </span>-&gt;<span class="w"> </span>physical<span class="w"> </span>GPU<span class="w"> </span><span class="o">(</span>device:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>name:<span class="w"> </span>GeForce<span class="w"> </span>GTX<span class="w"> </span><span class="m">1080</span><span class="w"> </span>Ti,<span class="w"> </span>pci<span class="w"> </span>bus<span class="w"> </span>id:<span class="w"> </span><span class="m">0000</span>:81:00.0,<span class="w"> </span>compute<span class="w"> </span>capability:<span class="w"> </span><span class="m">6</span>.1<span class="o">)</span>
<a id="__codelineno-8-37" name="__codelineno-8-37"></a><span class="c1"># each epoch has a line , giving results on train and validation, the validation set is always the last 20% of the data.</span>
<a id="__codelineno-8-38" name="__codelineno-8-38"></a><span class="c1"># see below some more explaining on how to understand the measures and results printed.</span>
<a id="__codelineno-8-39" name="__codelineno-8-39"></a><span class="m">1298692</span>/1298692<span class="w"> </span><span class="o">[==============================]</span><span class="w"> </span>-<span class="w"> </span>249s<span class="w"> </span>192us/step<span class="w"> </span>-<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.1734<span class="w"> </span>-<span class="w"> </span>w_bin_cross:<span class="w"> </span><span class="m">0</span>.1637<span class="w"> </span>-<span class="w"> </span>espec:<span class="w"> </span><span class="m">0</span>.0289<span class="w"> </span>-<span class="w"> </span>enpv:<span class="w"> </span><span class="m">0</span>.0039<span class="w"> </span>-<span class="w"> </span>ppv:<span class="w"> </span><span class="m">0</span>.3799<span class="w"> </span>-<span class="w"> </span>sens:<span class="w"> </span><span class="m">0</span>.8203<span class="w"> </span>-<span class="w"> </span>val_loss:<span class="w"> </span><span class="m">0</span>.1578<span class="w"> </span>-<span class="w"> </span>val_w_bin_cross:<span class="w"> </span><span class="m">0</span>.1476<span class="w"> </span>-<span class="w"> </span>val_espec:<span class="w"> </span><span class="m">0</span>.0232<span class="w"> </span>-<span class="w"> </span>val_enpv:<span class="w"> </span><span class="m">0</span>.0037<span class="w"> </span>-<span class="w"> </span>val_ppv:<span class="w"> </span><span class="m">0</span>.4295<span class="w"> </span>-<span class="w"> </span>val_sens:<span class="w"> </span><span class="m">0</span>.8253
<a id="__codelineno-8-40" name="__codelineno-8-40"></a>Epoch<span class="w"> </span><span class="m">2</span>/5
<a id="__codelineno-8-41" name="__codelineno-8-41"></a><span class="m">1298692</span>/1298692<span class="w"> </span><span class="o">[==============================]</span><span class="w"> </span>-<span class="w"> </span>302s<span class="w"> </span>233us/step<span class="w"> </span>-<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.1339<span class="w"> </span>-<span class="w"> </span>w_bin_cross:<span class="w"> </span><span class="m">0</span>.1238<span class="w"> </span>-<span class="w"> </span>espec:<span class="w"> </span><span class="m">0</span>.0240<span class="w"> </span>-<span class="w"> </span>enpv:<span class="w"> </span><span class="m">0</span>.0028<span class="w"> </span>-<span class="w"> </span>ppv:<span class="w"> </span><span class="m">0</span>.4370<span class="w"> </span>-<span class="w"> </span>sens:<span class="w"> </span><span class="m">0</span>.8735<span class="w"> </span>-<span class="w"> </span>val_loss:<span class="w"> </span><span class="m">0</span>.1362<span class="w"> </span>-<span class="w"> </span>val_w_bin_cross:<span class="w"> </span><span class="m">0</span>.1261<span class="w"> </span>-<span class="w"> </span>val_espec:<span class="w"> </span><span class="m">0</span>.0219<span class="w"> </span>-<span class="w"> </span>val_enpv:<span class="w"> </span><span class="m">0</span>.0030<span class="w"> </span>-<span class="w"> </span>val_ppv:<span class="w"> </span><span class="m">0</span>.4558<span class="w"> </span>-<span class="w"> </span>val_sens:<span class="w"> </span><span class="m">0</span>.8564
<a id="__codelineno-8-42" name="__codelineno-8-42"></a>Epoch<span class="w"> </span><span class="m">3</span>/5
<a id="__codelineno-8-43" name="__codelineno-8-43"></a><span class="m">1298692</span>/1298692<span class="w"> </span><span class="o">[==============================]</span><span class="w"> </span>-<span class="w"> </span>329s<span class="w"> </span>253us/step<span class="w"> </span>-<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.1221<span class="w"> </span>-<span class="w"> </span>w_bin_cross:<span class="w"> </span><span class="m">0</span>.1120<span class="w"> </span>-<span class="w"> </span>espec:<span class="w"> </span><span class="m">0</span>.0224<span class="w"> </span>-<span class="w"> </span>enpv:<span class="w"> </span><span class="m">0</span>.0024<span class="w"> </span>-<span class="w"> </span>ppv:<span class="w"> </span><span class="m">0</span>.4584<span class="w"> </span>-<span class="w"> </span>sens:<span class="w"> </span><span class="m">0</span>.8885<span class="w"> </span>-<span class="w"> </span>val_loss:<span class="w"> </span><span class="m">0</span>.1345<span class="w"> </span>-<span class="w"> </span>val_w_bin_cross:<span class="w"> </span><span class="m">0</span>.1245<span class="w"> </span>-<span class="w"> </span>val_espec:<span class="w"> </span><span class="m">0</span>.0214<span class="w"> </span>-<span class="w"> </span>val_enpv:<span class="w"> </span><span class="m">0</span>.0029<span class="w"> </span>-<span class="w"> </span>val_ppv:<span class="w"> </span><span class="m">0</span>.4626<span class="w"> </span>-<span class="w"> </span>val_sens:<span class="w"> </span><span class="m">0</span>.8640
<a id="__codelineno-8-44" name="__codelineno-8-44"></a><span class="c1"># note epoch 4 started to climb back in val_loss ... this might be a sign for a need to better regularize the model, as it seems to start entering an overfit state</span>
<a id="__codelineno-8-45" name="__codelineno-8-45"></a>Epoch<span class="w"> </span><span class="m">4</span>/5
<a id="__codelineno-8-46" name="__codelineno-8-46"></a><span class="m">1298692</span>/1298692<span class="w"> </span><span class="o">[==============================]</span><span class="w"> </span>-<span class="w"> </span>304s<span class="w"> </span>234us/step<span class="w"> </span>-<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.1156<span class="w"> </span>-<span class="w"> </span>w_bin_cross:<span class="w"> </span><span class="m">0</span>.1056<span class="w"> </span>-<span class="w"> </span>espec:<span class="w"> </span><span class="m">0</span>.0215<span class="w"> </span>-<span class="w"> </span>enpv:<span class="w"> </span><span class="m">0</span>.0023<span class="w"> </span>-<span class="w"> </span>ppv:<span class="w"> </span><span class="m">0</span>.4706<span class="w"> </span>-<span class="w"> </span>sens:<span class="w"> </span><span class="m">0</span>.8967<span class="w"> </span>-<span class="w"> </span>val_loss:<span class="w"> </span><span class="m">0</span>.1542<span class="w"> </span>-<span class="w"> </span>val_w_bin_cross:<span class="w"> </span><span class="m">0</span>.1442<span class="w"> </span>-<span class="w"> </span>val_espec:<span class="w"> </span><span class="m">0</span>.0306<span class="w"> </span>-<span class="w"> </span>val_enpv:<span class="w"> </span><span class="m">0</span>.0025<span class="w"> </span>-<span class="w"> </span>val_ppv:<span class="w"> </span><span class="m">0</span>.3752<span class="w"> </span>-<span class="w"> </span>val_sens:<span class="w"> </span><span class="m">0</span>.8867
<a id="__codelineno-8-47" name="__codelineno-8-47"></a><span class="c1"># last epoch , seems val_loss started to go down again, so we got a better model at the end. Still loss is smaller than val_loss, showing a potential for better regularizing.</span>
<a id="__codelineno-8-48" name="__codelineno-8-48"></a>Epoch<span class="w"> </span><span class="m">5</span>/5
<a id="__codelineno-8-49" name="__codelineno-8-49"></a><span class="w"> </span><span class="m">1298692</span>/1298692<span class="w"> </span><span class="o">[==============================]</span><span class="w"> </span>-<span class="w"> </span>333s<span class="w"> </span>257us/step<span class="w"> </span>-<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.1111<span class="w"> </span>-<span class="w"> </span>w_bin_cross:<span class="w"> </span><span class="m">0</span>.1011<span class="w"> </span>-<span class="w"> </span>espec:<span class="w"> </span><span class="m">0</span>.0209<span class="w"> </span>-<span class="w"> </span>enpv:<span class="w"> </span><span class="m">0</span>.0021<span class="w"> </span>-<span class="w"> </span>ppv:<span class="w"> </span><span class="m">0</span>.4798<span class="w"> </span>-<span class="w"> </span>sens:<span class="w"> </span><span class="m">0</span>.9024<span class="w"> </span>-<span class="w"> </span>val_loss:<span class="w"> </span><span class="m">0</span>.1213<span class="w"> </span>-<span class="w"> </span>val_w_bin_cross:<span class="w"> </span><span class="m">0</span>.1114<span class="w"> </span>-<span class="w"> </span>val_espec:<span class="w"> </span><span class="m">0</span>.0216<span class="w"> </span>-<span class="w"> </span>val_enpv:<span class="w"> </span><span class="m">0</span>.0024<span class="w"> </span>-<span class="w"> </span>val_ppv:<span class="w"> </span><span class="m">0</span>.4627<span class="w"> </span>-<span class="w"> </span>val_sens:<span class="w"> </span><span class="m">0</span>.8862
<a id="__codelineno-8-50" name="__codelineno-8-50"></a><span class="c1"># now follows is the ending in which the output files are created </span>
<a id="__codelineno-8-51" name="__codelineno-8-51"></a><span class="w"> </span>Writing<span class="w"> </span>model<span class="w"> </span>to<span class="w"> </span>files
<a id="__codelineno-8-52" name="__codelineno-8-52"></a><span class="o">(</span><span class="s1">&#39;History: &#39;</span>,<span class="w"> </span>&lt;keras.callbacks.History<span class="w"> </span>object<span class="w"> </span>at<span class="w"> </span>0x6fa5690&gt;,<span class="w"> </span><span class="o">{</span><span class="s1">&#39;val_espec&#39;</span>:<span class="w"> </span><span class="o">[</span><span class="m">0</span>.023174003757131564,<span class="w"> </span><span class="m">0</span>.021862880609978624,<span class="w"> </span><span class="m">0</span>.021418394041715545,<span class="w"> </span><span class="m">0</span>.03055855377804435,<span class="w"> </span><span class="m">0</span>.021563341807379736<span class="o">]</span>,<span class="w"> </span><span class="s1">&#39;val_w_bin_cross&#39;</span>:<span class="w"> </span><span class="o">[</span><span class="m">0</span>.14756845901125903,<span class="w"> </span><span class="m">0</span>.12613012184193115,<span class="w"> </span><span class="m">0</span>.12453776885398905,<span class="w"> </span><span class="m">0</span>.14417843291107432,<span class="w"> </span><span class="m">0</span>.11137183862486143<span class="o">]</span>,<span class="w"> </span><span class="s1">&#39;val_sens&#39;</span>:<span class="w"> </span><span class="o">[</span><span class="m">0</span>.8253292080568654,<span class="w"> </span><span class="m">0</span>.8563854553455446,<span class="w"> </span><span class="m">0</span>.8639981839122339,<span class="w"> </span><span class="m">0</span>.8866606718251948,<span class="w"> </span><span class="m">0</span>.8861758074101623<span class="o">]</span>,<span class="w"> </span><span class="s1">&#39;val_enpv&#39;</span>:<span class="w"> </span><span class="o">[</span><span class="m">0</span>.0037238269219488115,<span class="w"> </span><span class="m">0</span>.003042069682342851,<span class="w"> </span><span class="m">0</span>.002891325553422261,<span class="w"> </span><span class="m">0</span>.0024709458833944,<span class="w"> </span><span class="m">0</span>.0024423540647124592<span class="o">]</span>,<span class="w"> </span><span class="s1">&#39;val_ppv&#39;</span>:<span class="w"> </span><span class="o">[</span><span class="m">0</span>.4295036114702129,<span class="w"> </span><span class="m">0</span>.4557987501766982,<span class="w"> </span><span class="m">0</span>.4626011239199966,<span class="w"> </span><span class="m">0</span>.3751608240688261,<span class="w"> </span><span class="m">0</span>.4627356967393517<span class="o">]</span>,<span class="w"> </span><span class="s1">&#39;enpv&#39;</span>:<span class="w"> </span><span class="o">[</span><span class="m">0</span>.003947158052682541,<span class="w"> </span><span class="m">0</span>.0027687939362956364,<span class="w"> </span><span class="m">0</span>.002437750546613879,<span class="w"> </span><span class="m">0</span>.0022583779117050936,<span class="w"> </span><span class="m">0</span>.002131666025525145<span class="o">]</span>,<span class="w"> </span><span class="s1">&#39;val_loss&#39;</span>:<span class="w"> </span><span class="o">[</span><span class="m">0</span>.15775366971853721,<span class="w"> </span><span class="m">0</span>.13624100354358956,<span class="w"> </span><span class="m">0</span>.13452252385947847,<span class="w"> </span><span class="m">0</span>.15421950637508852,<span class="w"> </span><span class="m">0</span>.12133861386228599<span class="o">]</span>,<span class="w"> </span><span class="s1">&#39;ppv&#39;</span>:<span class="w"> </span><span class="o">[</span><span class="m">0</span>.3798841048923378,<span class="w"> </span><span class="m">0</span>.43695378672384044,<span class="w"> </span><span class="m">0</span>.4583713526026837,<span class="w"> </span><span class="m">0</span>.47056864791872133,<span class="w"> </span><span class="m">0</span>.4798394423932855<span class="o">]</span>,<span class="w"> </span><span class="s1">&#39;w_bin_cross&#39;</span>:<span class="w"> </span><span class="o">[</span><span class="m">0</span>.16372003288450798,<span class="w"> </span><span class="m">0</span>.12379132172316154,<span class="w"> </span><span class="m">0</span>.11200136639712739,<span class="w"> </span><span class="m">0</span>.10560965182129696,<span class="w"> </span><span class="m">0</span>.10111237579286037<span class="o">]</span>,<span class="w"> </span><span class="s1">&#39;sens&#39;</span>:<span class="w"> </span><span class="o">[</span><span class="m">0</span>.8202563503519625,<span class="w"> </span><span class="m">0</span>.8735020021500306,<span class="w"> </span><span class="m">0</span>.8885229580472642,<span class="w"> </span><span class="m">0</span>.8966689669803886,<span class="w"> </span><span class="m">0</span>.9024332567701953<span class="o">]</span>,<span class="w"> </span><span class="s1">&#39;loss&#39;</span>:<span class="w"> </span><span class="o">[</span><span class="m">0</span>.17342430566917966,<span class="w"> </span><span class="m">0</span>.13392729285731664,<span class="w"> </span><span class="m">0</span>.1220678161909718,<span class="w"> </span><span class="m">0</span>.11563198370958765,<span class="w"> </span><span class="m">0</span>.11113599371116904<span class="o">]</span>,<span class="w"> </span><span class="s1">&#39;espec&#39;</span>:<span class="w"> </span><span class="o">[</span><span class="m">0</span>.028870824286393815,<span class="w"> </span><span class="m">0</span>.02403844574438139,<span class="w"> </span><span class="m">0</span>.02241259005779445,<span class="w"> </span><span class="m">0</span>.021534086913695155,<span class="w"> </span><span class="m">0</span>.020883613924218173<span class="o">]})</span>
<a id="__codelineno-8-53" name="__codelineno-8-53"></a>_________________________________________________________________
<a id="__codelineno-8-54" name="__codelineno-8-54"></a>Layer<span class="w"> </span><span class="o">(</span><span class="nb">type</span><span class="o">)</span><span class="w">                 </span>Output<span class="w"> </span>Shape<span class="w">              </span>Param<span class="w"> </span><span class="c1">#</span>
<a id="__codelineno-8-55" name="__codelineno-8-55"></a><span class="o">=================================================================</span>
<a id="__codelineno-8-56" name="__codelineno-8-56"></a>input_1<span class="w"> </span><span class="o">(</span>InputLayer<span class="o">)</span><span class="w">         </span><span class="o">(</span>None,<span class="w"> </span><span class="m">11933</span><span class="o">)</span><span class="w">             </span><span class="m">0</span>
<a id="__codelineno-8-57" name="__codelineno-8-57"></a>_________________________________________________________________
<a id="__codelineno-8-58" name="__codelineno-8-58"></a>dropout_1<span class="w"> </span><span class="o">(</span>Dropout<span class="o">)</span><span class="w">          </span><span class="o">(</span>None,<span class="w"> </span><span class="m">11933</span><span class="o">)</span><span class="w">             </span><span class="m">0</span>
<a id="__codelineno-8-59" name="__codelineno-8-59"></a>_________________________________________________________________
<a id="__codelineno-8-60" name="__codelineno-8-60"></a>dense_1<span class="w"> </span><span class="o">(</span>Dense<span class="o">)</span><span class="w">              </span><span class="o">(</span>None,<span class="w"> </span><span class="m">400</span><span class="o">)</span><span class="w">               </span><span class="m">4773600</span>
<a id="__codelineno-8-61" name="__codelineno-8-61"></a>_________________________________________________________________
<a id="__codelineno-8-62" name="__codelineno-8-62"></a>leaky_re_lu_1<span class="w"> </span><span class="o">(</span>LeakyReLU<span class="o">)</span><span class="w">    </span><span class="o">(</span>None,<span class="w"> </span><span class="m">400</span><span class="o">)</span><span class="w">               </span><span class="m">0</span>
<a id="__codelineno-8-63" name="__codelineno-8-63"></a>_________________________________________________________________
<a id="__codelineno-8-64" name="__codelineno-8-64"></a>dropout_2<span class="w"> </span><span class="o">(</span>Dropout<span class="o">)</span><span class="w">          </span><span class="o">(</span>None,<span class="w"> </span><span class="m">400</span><span class="o">)</span><span class="w">               </span><span class="m">0</span>
<a id="__codelineno-8-65" name="__codelineno-8-65"></a>_________________________________________________________________
<a id="__codelineno-8-66" name="__codelineno-8-66"></a>dense_2<span class="w"> </span><span class="o">(</span>Dense<span class="o">)</span><span class="w">              </span><span class="o">(</span>None,<span class="w"> </span><span class="m">200</span><span class="o">)</span><span class="w">               </span><span class="m">80200</span>
<a id="__codelineno-8-67" name="__codelineno-8-67"></a>_________________________________________________________________
<a id="__codelineno-8-68" name="__codelineno-8-68"></a>leaky_re_lu_2<span class="w"> </span><span class="o">(</span>LeakyReLU<span class="o">)</span><span class="w">    </span><span class="o">(</span>None,<span class="w"> </span><span class="m">200</span><span class="o">)</span><span class="w">               </span><span class="m">0</span>
<a id="__codelineno-8-69" name="__codelineno-8-69"></a>_________________________________________________________________
<a id="__codelineno-8-70" name="__codelineno-8-70"></a>dropout_3<span class="w"> </span><span class="o">(</span>Dropout<span class="o">)</span><span class="w">          </span><span class="o">(</span>None,<span class="w"> </span><span class="m">200</span><span class="o">)</span><span class="w">               </span><span class="m">0</span>
<a id="__codelineno-8-71" name="__codelineno-8-71"></a>_________________________________________________________________
<a id="__codelineno-8-72" name="__codelineno-8-72"></a>dense_3<span class="w"> </span><span class="o">(</span>Dense<span class="o">)</span><span class="w">              </span><span class="o">(</span>None,<span class="w"> </span><span class="m">100</span><span class="o">)</span><span class="w">               </span><span class="m">20100</span>
<a id="__codelineno-8-73" name="__codelineno-8-73"></a>_________________________________________________________________
<a id="__codelineno-8-74" name="__codelineno-8-74"></a>leaky_re_lu_3<span class="w"> </span><span class="o">(</span>LeakyReLU<span class="o">)</span><span class="w">    </span><span class="o">(</span>None,<span class="w"> </span><span class="m">100</span><span class="o">)</span><span class="w">               </span><span class="m">0</span>
<a id="__codelineno-8-75" name="__codelineno-8-75"></a>_________________________________________________________________
<a id="__codelineno-8-76" name="__codelineno-8-76"></a>batch_normalization_1<span class="w"> </span><span class="o">(</span>Batch<span class="w"> </span><span class="o">(</span>None,<span class="w"> </span><span class="m">100</span><span class="o">)</span><span class="w">               </span><span class="m">400</span>
<a id="__codelineno-8-77" name="__codelineno-8-77"></a>_________________________________________________________________
<a id="__codelineno-8-78" name="__codelineno-8-78"></a>gaussian_noise_1<span class="w"> </span><span class="o">(</span>GaussianNo<span class="w"> </span><span class="o">(</span>None,<span class="w"> </span><span class="m">100</span><span class="o">)</span><span class="w">               </span><span class="m">0</span>
<a id="__codelineno-8-79" name="__codelineno-8-79"></a>_________________________________________________________________
<a id="__codelineno-8-80" name="__codelineno-8-80"></a>dropout_4<span class="w"> </span><span class="o">(</span>Dropout<span class="o">)</span><span class="w">          </span><span class="o">(</span>None,<span class="w"> </span><span class="m">100</span><span class="o">)</span><span class="w">               </span><span class="m">0</span>
<a id="__codelineno-8-81" name="__codelineno-8-81"></a>_________________________________________________________________
<a id="__codelineno-8-82" name="__codelineno-8-82"></a>dropout_5<span class="w"> </span><span class="o">(</span>Dropout<span class="o">)</span><span class="w">          </span><span class="o">(</span>None,<span class="w"> </span><span class="m">100</span><span class="o">)</span><span class="w">               </span><span class="m">0</span>
<a id="__codelineno-8-83" name="__codelineno-8-83"></a>_________________________________________________________________
<a id="__codelineno-8-84" name="__codelineno-8-84"></a>dense_4<span class="w"> </span><span class="o">(</span>Dense<span class="o">)</span><span class="w">              </span><span class="o">(</span>None,<span class="w"> </span><span class="m">200</span><span class="o">)</span><span class="w">               </span><span class="m">20200</span>
<a id="__codelineno-8-85" name="__codelineno-8-85"></a>_________________________________________________________________
<a id="__codelineno-8-86" name="__codelineno-8-86"></a>leaky_re_lu_4<span class="w"> </span><span class="o">(</span>LeakyReLU<span class="o">)</span><span class="w">    </span><span class="o">(</span>None,<span class="w"> </span><span class="m">200</span><span class="o">)</span><span class="w">               </span><span class="m">0</span>
<a id="__codelineno-8-87" name="__codelineno-8-87"></a>_________________________________________________________________
<a id="__codelineno-8-88" name="__codelineno-8-88"></a>dropout_6<span class="w"> </span><span class="o">(</span>Dropout<span class="o">)</span><span class="w">          </span><span class="o">(</span>None,<span class="w"> </span><span class="m">200</span><span class="o">)</span><span class="w">               </span><span class="m">0</span>
<a id="__codelineno-8-89" name="__codelineno-8-89"></a>_________________________________________________________________
<a id="__codelineno-8-90" name="__codelineno-8-90"></a>dense_5<span class="w"> </span><span class="o">(</span>Dense<span class="o">)</span><span class="w">              </span><span class="o">(</span>None,<span class="w"> </span><span class="m">400</span><span class="o">)</span><span class="w">               </span><span class="m">80400</span>
<a id="__codelineno-8-91" name="__codelineno-8-91"></a>_________________________________________________________________
<a id="__codelineno-8-92" name="__codelineno-8-92"></a>dense_6<span class="w"> </span><span class="o">(</span>Dense<span class="o">)</span><span class="w">              </span><span class="o">(</span>None,<span class="w"> </span><span class="m">3986</span><span class="o">)</span><span class="w">              </span><span class="nv">1598386</span>
<a id="__codelineno-8-93" name="__codelineno-8-93"></a><span class="o">=================================================================</span>
<a id="__codelineno-8-94" name="__codelineno-8-94"></a>Total<span class="w"> </span>params:<span class="w"> </span><span class="m">6</span>,573,286
<a id="__codelineno-8-95" name="__codelineno-8-95"></a>Trainable<span class="w"> </span>params:<span class="w"> </span><span class="m">6</span>,573,086
<a id="__codelineno-8-96" name="__codelineno-8-96"></a>Non-trainable<span class="w"> </span>params:<span class="w"> </span><span class="m">200</span>
<a id="__codelineno-8-97" name="__codelineno-8-97"></a>_________________________________________________________________
<a id="__codelineno-8-98" name="__codelineno-8-98"></a>Printing<span class="w"> </span>model<span class="w"> </span>layers
<a id="__codelineno-8-99" name="__codelineno-8-99"></a><span class="nv">NLAYERS</span><span class="o">=</span><span class="w"> </span><span class="m">19</span>
<a id="__codelineno-8-100" name="__codelineno-8-100"></a>LAYER<span class="w"> </span><span class="nv">type</span><span class="o">=</span>dropout<span class="p">;</span><span class="nv">name</span><span class="o">=</span>dropout_1<span class="p">;</span><span class="nv">drop_rate</span><span class="o">=</span><span class="m">0</span>.000000
<a id="__codelineno-8-101" name="__codelineno-8-101"></a>LAYER<span class="w"> </span><span class="nv">type</span><span class="o">=</span>dense<span class="p">;</span><span class="nv">name</span><span class="o">=</span>dense_1<span class="p">;</span><span class="nv">activation</span><span class="o">=</span>linear<span class="p">;</span><span class="nv">in_dim</span><span class="o">=</span><span class="m">11933</span><span class="p">;</span><span class="nv">out_dim</span><span class="o">=</span><span class="m">400</span><span class="p">;</span><span class="nv">n_bias</span><span class="o">=</span><span class="m">400</span>
<a id="__codelineno-8-102" name="__codelineno-8-102"></a>LAYER<span class="w"> </span><span class="nv">type</span><span class="o">=</span>leaky<span class="p">;</span><span class="nv">name</span><span class="o">=</span>leaky_re_lu_1<span class="p">;</span><span class="nv">leaky_alpha</span><span class="o">=</span><span class="m">0</span>.100000
<a id="__codelineno-8-103" name="__codelineno-8-103"></a>LAYER<span class="w"> </span><span class="nv">type</span><span class="o">=</span>dropout<span class="p">;</span><span class="nv">name</span><span class="o">=</span>dropout_2<span class="p">;</span><span class="nv">drop_rate</span><span class="o">=</span><span class="m">0</span>.000000
<a id="__codelineno-8-104" name="__codelineno-8-104"></a>LAYER<span class="w"> </span><span class="nv">type</span><span class="o">=</span>dense<span class="p">;</span><span class="nv">name</span><span class="o">=</span>dense_2<span class="p">;</span><span class="nv">activation</span><span class="o">=</span>linear<span class="p">;</span><span class="nv">in_dim</span><span class="o">=</span><span class="m">400</span><span class="p">;</span><span class="nv">out_dim</span><span class="o">=</span><span class="m">200</span><span class="p">;</span><span class="nv">n_bias</span><span class="o">=</span><span class="m">200</span>
<a id="__codelineno-8-105" name="__codelineno-8-105"></a>LAYER<span class="w"> </span><span class="nv">type</span><span class="o">=</span>leaky<span class="p">;</span><span class="nv">name</span><span class="o">=</span>leaky_re_lu_2<span class="p">;</span><span class="nv">leaky_alpha</span><span class="o">=</span><span class="m">0</span>.100000
<a id="__codelineno-8-106" name="__codelineno-8-106"></a>LAYER<span class="w"> </span><span class="nv">type</span><span class="o">=</span>dropout<span class="p">;</span><span class="nv">name</span><span class="o">=</span>dropout_3<span class="p">;</span><span class="nv">drop_rate</span><span class="o">=</span><span class="m">0</span>.000000
<a id="__codelineno-8-107" name="__codelineno-8-107"></a>LAYER<span class="w"> </span><span class="nv">type</span><span class="o">=</span>dense<span class="p">;</span><span class="nv">name</span><span class="o">=</span>dense_3<span class="p">;</span><span class="nv">activation</span><span class="o">=</span>linear<span class="p">;</span><span class="nv">in_dim</span><span class="o">=</span><span class="m">200</span><span class="p">;</span><span class="nv">out_dim</span><span class="o">=</span><span class="m">100</span><span class="p">;</span><span class="nv">n_bias</span><span class="o">=</span><span class="m">100</span>
<a id="__codelineno-8-108" name="__codelineno-8-108"></a>LAYER<span class="w"> </span><span class="nv">type</span><span class="o">=</span>leaky<span class="p">;</span><span class="nv">name</span><span class="o">=</span>leaky_re_lu_3<span class="p">;</span><span class="nv">leaky_alpha</span><span class="o">=</span><span class="m">0</span>.100000
<a id="__codelineno-8-109" name="__codelineno-8-109"></a>LAYER<span class="w"> </span><span class="nv">type</span><span class="o">=</span>batch_normalization<span class="p">;</span><span class="nv">name</span><span class="o">=</span>batch_normalization_1<span class="p">;</span><span class="nv">dim</span><span class="o">=</span><span class="m">100</span>
<a id="__codelineno-8-110" name="__codelineno-8-110"></a>LAYER<span class="w"> </span><span class="nv">type</span><span class="o">=</span>dropout<span class="p">;</span><span class="nv">name</span><span class="o">=</span>dropout_4<span class="p">;</span><span class="nv">drop_rate</span><span class="o">=</span><span class="m">0</span>.000000
<a id="__codelineno-8-111" name="__codelineno-8-111"></a>LAYER<span class="w"> </span><span class="nv">type</span><span class="o">=</span>dropout<span class="p">;</span><span class="nv">name</span><span class="o">=</span>dropout_5<span class="p">;</span><span class="nv">drop_rate</span><span class="o">=</span><span class="m">0</span>.000000
<a id="__codelineno-8-112" name="__codelineno-8-112"></a>LAYER<span class="w"> </span><span class="nv">type</span><span class="o">=</span>dense<span class="p">;</span><span class="nv">name</span><span class="o">=</span>dense_4<span class="p">;</span><span class="nv">activation</span><span class="o">=</span>linear<span class="p">;</span><span class="nv">in_dim</span><span class="o">=</span><span class="m">100</span><span class="p">;</span><span class="nv">out_dim</span><span class="o">=</span><span class="m">200</span><span class="p">;</span><span class="nv">n_bias</span><span class="o">=</span><span class="m">200</span>
<a id="__codelineno-8-113" name="__codelineno-8-113"></a>LAYER<span class="w"> </span><span class="nv">type</span><span class="o">=</span>leaky<span class="p">;</span><span class="nv">name</span><span class="o">=</span>leaky_re_lu_4<span class="p">;</span><span class="nv">leaky_alpha</span><span class="o">=</span><span class="m">0</span>.100000
<a id="__codelineno-8-114" name="__codelineno-8-114"></a>LAYER<span class="w"> </span><span class="nv">type</span><span class="o">=</span>dropout<span class="p">;</span><span class="nv">name</span><span class="o">=</span>dropout_6<span class="p">;</span><span class="nv">drop_rate</span><span class="o">=</span><span class="m">0</span>.000000
<a id="__codelineno-8-115" name="__codelineno-8-115"></a>LAYER<span class="w"> </span><span class="nv">type</span><span class="o">=</span>dense<span class="p">;</span><span class="nv">name</span><span class="o">=</span>dense_5<span class="p">;</span><span class="nv">activation</span><span class="o">=</span>linear<span class="p">;</span><span class="nv">in_dim</span><span class="o">=</span><span class="m">200</span><span class="p">;</span><span class="nv">out_dim</span><span class="o">=</span><span class="m">400</span><span class="p">;</span><span class="nv">n_bias</span><span class="o">=</span><span class="m">400</span>
<a id="__codelineno-8-116" name="__codelineno-8-116"></a>LAYER<span class="w"> </span><span class="nv">type</span><span class="o">=</span>dense<span class="p">;</span><span class="nv">name</span><span class="o">=</span>dense_6<span class="p">;</span><span class="nv">activation</span><span class="o">=</span>sigmoid<span class="p">;</span><span class="nv">in_dim</span><span class="o">=</span><span class="m">400</span><span class="p">;</span><span class="nv">out_dim</span><span class="o">=</span><span class="m">3986</span><span class="p">;</span><span class="nv">n_bias</span><span class="o">=</span><span class="m">3986</span>
<a id="__codelineno-8-117" name="__codelineno-8-117"></a><span class="c1"># that&#39;s it !! we succesfully trained the model</span>
<a id="__codelineno-8-118" name="__codelineno-8-118"></a><span class="c1"># at the end these are the files created :</span>
<a id="__codelineno-8-119" name="__codelineno-8-119"></a><span class="c1"># file created by keras to contain the model structure</span>
<a id="__codelineno-8-120" name="__codelineno-8-120"></a>-rwxrwxrwx.<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">       </span><span class="m">6599</span><span class="w"> </span>Feb<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">13</span>:41<span class="w"> </span>emodel.json
<a id="__codelineno-8-121" name="__codelineno-8-121"></a><span class="c1"># the model parameters in keras bin format</span>
<a id="__codelineno-8-122" name="__codelineno-8-122"></a>-rwxrwxrwx.<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">   </span><span class="m">78938688</span><span class="w"> </span>Feb<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">13</span>:41<span class="w"> </span>emodel.h5
<a id="__codelineno-8-123" name="__codelineno-8-123"></a><span class="c1"># the model parameters in our simple .layers format that can be read using our infrastructure</span>
<a id="__codelineno-8-124" name="__codelineno-8-124"></a>-rwxrwxrwx.<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">   </span><span class="m">62422454</span><span class="w"> </span>Feb<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">13</span>:41<span class="w"> </span>emodel.layers
<a id="__codelineno-8-125" name="__codelineno-8-125"></a><span class="c1"># keeping the command line used to create the model : very useful and important if going to continue training or repeat it</span>
<a id="__codelineno-8-126" name="__codelineno-8-126"></a>-rwxrwxrwx.<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">        </span><span class="m">170</span><span class="w"> </span>Feb<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">13</span>:41<span class="w"> </span>emodel_command_line.txt
<a id="__codelineno-8-127" name="__codelineno-8-127"></a><span class="c1"># history of results on train and validation, can be used to draw charts of model training process</span>
<a id="__codelineno-8-128" name="__codelineno-8-128"></a>-rwxrwxrwx.<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">      </span><span class="m">35160</span><span class="w"> </span>Feb<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">13</span>:41<span class="w"> </span>emodel.history
<a id="__codelineno-8-129" name="__codelineno-8-129"></a><span class="c1"># you can pick up a model you trained and continue its training. Here we use the emodel trained before to continue and save into emodel2</span>
<a id="__codelineno-8-130" name="__codelineno-8-130"></a><span class="c1"># the model will initialize itself from the emodel.json and emodel.h5 files, and then continue training and save to emodel2</span>
<a id="__codelineno-8-131" name="__codelineno-8-131"></a>python<span class="w"> </span>./Embedder.py<span class="w"> </span>--xfile<span class="w"> </span>./x.smat<span class="w"> </span>--yfile<span class="w"> </span>./y.smat<span class="w"> </span>--nepochs<span class="w"> </span><span class="m">5</span><span class="w"> </span>--out_model<span class="w"> </span>emodel2<span class="w"> </span>--in_model<span class="w"> </span>emodel<span class="w"> </span>--train<span class="w"> </span>--gpu<span class="w"> </span><span class="m">1</span>
<a id="__codelineno-8-132" name="__codelineno-8-132"></a><span class="w"> </span>
<a id="__codelineno-8-133" name="__codelineno-8-133"></a><span class="c1"># skipping ...</span>
<a id="__codelineno-8-134" name="__codelineno-8-134"></a><span class="w"> </span>
<a id="__codelineno-8-135" name="__codelineno-8-135"></a>Epoch<span class="w"> </span><span class="m">1</span>/5
<a id="__codelineno-8-136" name="__codelineno-8-136"></a><span class="m">1298692</span>/1298692<span class="w"> </span><span class="o">[==============================]</span><span class="w"> </span>-<span class="w"> </span>294s<span class="w"> </span>227us/step<span class="w"> </span>-<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.1073<span class="w"> </span>-<span class="w"> </span>w_bin_cross:<span class="w"> </span><span class="m">0</span>.0975<span class="w"> </span>-<span class="w"> </span>espec:<span class="w"> </span><span class="m">0</span>.0204<span class="w"> </span>-<span class="w"> </span>enpv:<span class="w"> </span><span class="m">0</span>.0020<span class="w"> </span>-<span class="w"> </span>ppv:<span class="w"> </span><span class="m">0</span>.4870<span class="w"> </span>-<span class="w"> </span>sens:<span class="w"> </span><span class="m">0</span>.9074<span class="w"> </span>-<span class="w"> </span>val_loss:<span class="w"> </span><span class="m">0</span>.1181<span class="w"> </span>-<span class="w"> </span>val_w_bin_cross:<span class="w"> </span><span class="m">0</span>.1082<span class="w"> </span>-<span class="w"> </span>val_espec:<span class="w"> </span><span class="m">0</span>.0185<span class="w"> </span>-<span class="w"> </span>val_enpv:<span class="w"> </span><span class="m">0</span>.0026<span class="w"> </span>-<span class="w"> </span>val_ppv:<span class="w"> </span><span class="m">0</span>.5010<span class="w"> </span>-<span class="w"> </span>val_sens:<span class="w"> </span><span class="m">0</span>.8770
<a id="__codelineno-8-137" name="__codelineno-8-137"></a>Epoch<span class="w"> </span><span class="m">2</span>/5
<a id="__codelineno-8-138" name="__codelineno-8-138"></a><span class="m">1298692</span>/1298692<span class="w"> </span><span class="o">[==============================]</span><span class="w"> </span>-<span class="w"> </span>226s<span class="w"> </span>174us/step<span class="w"> </span>-<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.1052<span class="w"> </span>-<span class="w"> </span>w_bin_cross:<span class="w"> </span><span class="m">0</span>.0954<span class="w"> </span>-<span class="w"> </span>espec:<span class="w"> </span><span class="m">0</span>.0202<span class="w"> </span>-<span class="w"> </span>enpv:<span class="w"> </span><span class="m">0</span>.0020<span class="w"> </span>-<span class="w"> </span>ppv:<span class="w"> </span><span class="m">0</span>.4904<span class="w"> </span>-<span class="w"> </span>sens:<span class="w"> </span><span class="m">0</span>.9101<span class="w"> </span>-<span class="w"> </span>val_loss:<span class="w"> </span><span class="m">0</span>.1156<span class="w"> </span>-<span class="w"> </span>val_w_bin_cross:<span class="w"> </span><span class="m">0</span>.1059<span class="w"> </span>-<span class="w"> </span>val_espec:<span class="w"> </span><span class="m">0</span>.0181<span class="w"> </span>-<span class="w"> </span>val_enpv:<span class="w"> </span><span class="m">0</span>.0025<span class="w"> </span>-<span class="w"> </span>val_ppv:<span class="w"> </span><span class="m">0</span>.5089<span class="w"> </span>-<span class="w"> </span>val_sens:<span class="w"> </span><span class="m">0</span>.8804
<a id="__codelineno-8-139" name="__codelineno-8-139"></a><span class="c1"># ...</span>
<a id="__codelineno-8-140" name="__codelineno-8-140"></a><span class="c1"># we were able to improve a little more.</span>
<a id="__codelineno-8-141" name="__codelineno-8-141"></a><span class="w"> </span>
</code></pre></div></td></tr></table></div>
<strong>Which is the Embedding layer?</strong>
The one just before the gaussian noise. We take the third layer, then batch normalize it , so that it is in the N(0,1) distribution on each channel, and then add noise (only in training). This is done in order to make sure our embedding layer gives numbers in a reasonable numerical range, is normalized, and that it is immune to noising each channel, making it a more stable embedding.
 
Some explanation on the model loss and evaluation:</li>
</ol>
<ul>
<li><strong>Loss function</strong> : we treat the y vector as a binary prediction goal, and to the whole problem as predicting together a vector of binary predictions (in the example above a vector of length 3986). The loss we take is the logloss on each channel , summed over all channels. You will note that our last layer before getting to the y layer is using sigmoid as activation into the y layer, hence predicting a probablily for each channel. Since the y vectors are very sparse we multiply by a weight the cases (y[i][j] == 1) , pushing the model to try better to be right on 1 predictions rather than 0 predictions.</li>
<li><strong>Evaluation</strong> : last 20% of x.y matrices (as they appear in the input files) are always used as evaluation data for the embedding training process, and you see that evaluation after each epoch.</li>
<li>Evaluation metrics (all metrics with val_ prefix are the same but on the validation 20% set). All our done at a point which sets &gt;=0.5 predictions as 1 and the others as 0.<ul>
<li>loss : overall loss value (as explained above). Big differences between train and validation group hints towards over fit we can try to regilarize (finding the best regularization usually improves results). Note that when using large data sets less regularization is needed. More data is always the best regularizer.</li>
<li>w_bin_cross : loss without the regularization terms (l1, l2).</li>
<li>ppv : #(true==1 &amp;&amp; prob&gt;=0.5) / # (prob &gt;= 0.5) : the probability of being right when predicting positive (larger is better)</li>
<li>sens : #(true==1 &amp;&amp; prob&gt;=0.5) / # (true == 1) : how many of the positives caught when predicting positive (larger is better)</li>
<li>enpv : #(true==1 &amp;&amp; prob&lt;0.5) / #(prob&lt;0.5) : the probability for error when predicting negative (lower is better)</li>
<li>espec : 1-#(true==0 &amp;&amp; prob&lt;0.5)/#(true == 0) : percentage of true negatives not predicted right out of all negatives (lower is better)
 </li>
</ul>
</li>
</ul>
<h2 id="step-7-testing-we-get-the-same-embeddings-in-keras-and-infrastructure">Step 7 : Testing we get the same embeddings in Keras and Infrastructure</h2>
<p>This is a needed sanity in order to verify the model we trained is indeed the one our infrastructure will use.</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span>
<span class="normal"><a href="#__codelineno-9-2">2</a></span>
<span class="normal"><a href="#__codelineno-9-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="c1"># assuming we prepared t_1.samples : a samples file with a single line</span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="c1"># we first create a sparse mat for this sample, we use the x.scheme file that was created when we first generated the x matrix</span>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a>Embeddings<span class="w"> </span>--gen_mat_from_scheme<span class="w"> </span>--f_samples<span class="w"> </span>./t_1.samples<span class="w"> </span>--f_scheme<span class="w"> </span>../x.scheme<span class="w"> </span>--prefix<span class="w"> </span>xtest
</code></pre></div></td></tr></table></div>
 </p>
<h3 id="this-created-the-xtestsmat-file">this created the xtest.smat file</h3>
<h3 id="we-can-now-check-it-directly-with-keras-using-the-following-line-the-model-will-initialize-from-the-json-and-h35-files">we can now check it directly with keras using the following line (the model will initialize from the .json and .h35 files):</h3>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a>python<span class="w"> </span>../Embedder.py<span class="w"> </span>--embed<span class="w"> </span>--in_model<span class="w"> </span>../emodel<span class="w"> </span>--xfile<span class="w"> </span>./xtest.smat<span class="w">  </span>
</code></pre></div></td></tr></table></div>
 </p>
<h3 id="result-is">result is :</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-11-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-11-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-11-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-11-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-11-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-11-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-11-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-11-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-11-10">10</a></span>
<span class="normal"><a href="#__codelineno-11-11">11</a></span>
<span class="normal"><a href="#__codelineno-11-12">12</a></span>
<span class="normal"><a href="#__codelineno-11-13">13</a></span>
<span class="normal"><a href="#__codelineno-11-14">14</a></span>
<span class="normal"><a href="#__codelineno-11-15">15</a></span>
<span class="normal"><a href="#__codelineno-11-16">16</a></span>
<span class="normal"><a href="#__codelineno-11-17">17</a></span>
<span class="normal"><a href="#__codelineno-11-18">18</a></span>
<span class="normal"><a href="#__codelineno-11-19">19</a></span>
<span class="normal"><a href="#__codelineno-11-20">20</a></span>
<span class="normal"><a href="#__codelineno-11-21">21</a></span>
<span class="normal"><a href="#__codelineno-11-22">22</a></span>
<span class="normal"><a href="#__codelineno-11-23">23</a></span>
<span class="normal"><a href="#__codelineno-11-24">24</a></span>
<span class="normal"><a href="#__codelineno-11-25">25</a></span>
<span class="normal"><a href="#__codelineno-11-26">26</a></span>
<span class="normal"><a href="#__codelineno-11-27">27</a></span>
<span class="normal"><a href="#__codelineno-11-28">28</a></span>
<span class="normal"><a href="#__codelineno-11-29">29</a></span>
<span class="normal"><a href="#__codelineno-11-30">30</a></span>
<span class="normal"><a href="#__codelineno-11-31">31</a></span>
<span class="normal"><a href="#__codelineno-11-32">32</a></span>
<span class="normal"><a href="#__codelineno-11-33">33</a></span>
<span class="normal"><a href="#__codelineno-11-34">34</a></span>
<span class="normal"><a href="#__codelineno-11-35">35</a></span>
<span class="normal"><a href="#__codelineno-11-36">36</a></span>
<span class="normal"><a href="#__codelineno-11-37">37</a></span>
<span class="normal"><a href="#__codelineno-11-38">38</a></span>
<span class="normal"><a href="#__codelineno-11-39">39</a></span>
<span class="normal"><a href="#__codelineno-11-40">40</a></span>
<span class="normal"><a href="#__codelineno-11-41">41</a></span>
<span class="normal"><a href="#__codelineno-11-42">42</a></span>
<span class="normal"><a href="#__codelineno-11-43">43</a></span>
<span class="normal"><a href="#__codelineno-11-44">44</a></span>
<span class="normal"><a href="#__codelineno-11-45">45</a></span>
<span class="normal"><a href="#__codelineno-11-46">46</a></span>
<span class="normal"><a href="#__codelineno-11-47">47</a></span>
<span class="normal"><a href="#__codelineno-11-48">48</a></span>
<span class="normal"><a href="#__codelineno-11-49">49</a></span>
<span class="normal"><a href="#__codelineno-11-50">50</a></span>
<span class="normal"><a href="#__codelineno-11-51">51</a></span>
<span class="normal"><a href="#__codelineno-11-52">52</a></span>
<span class="normal"><a href="#__codelineno-11-53">53</a></span>
<span class="normal"><a href="#__codelineno-11-54">54</a></span>
<span class="normal"><a href="#__codelineno-11-55">55</a></span>
<span class="normal"><a href="#__codelineno-11-56">56</a></span>
<span class="normal"><a href="#__codelineno-11-57">57</a></span>
<span class="normal"><a href="#__codelineno-11-58">58</a></span>
<span class="normal"><a href="#__codelineno-11-59">59</a></span>
<span class="normal"><a href="#__codelineno-11-60">60</a></span>
<span class="normal"><a href="#__codelineno-11-61">61</a></span>
<span class="normal"><a href="#__codelineno-11-62">62</a></span>
<span class="normal"><a href="#__codelineno-11-63">63</a></span>
<span class="normal"><a href="#__codelineno-11-64">64</a></span>
<span class="normal"><a href="#__codelineno-11-65">65</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a>Using TensorFlow backend.
<a id="__codelineno-11-2" name="__codelineno-11-2"></a>(&#39;arguments----&gt;&#39;, Namespace(dim=[400, 200, 100], dropout=[0.0, 0.0, 0.0], embed=True, full_decode=True, gpu=[0], in_model=[&#39;../emodel&#39;], l1=[1e-07, 0.0, 0.0], l2=[0.0, 0.0, 0.0], leaky=[0.1], nepochs=-1, no_shuffle=False, noise=[0.3], out_model=&#39;&#39;, test=False, train=False, wgt=[10.0], xdim=[11933], xfile=[&#39;./xtest.smat&#39;], ydim=[3986], yfile=&#39;my_y.smat&#39;))
<a id="__codelineno-11-3" name="__codelineno-11-3"></a>using gpu  0
<a id="__codelineno-11-4" name="__codelineno-11-4"></a>Embed mode
<a id="__codelineno-11-5" name="__codelineno-11-5"></a>(&#39;reading: &#39;, [&#39;./xtest.smat&#39;])
<a id="__codelineno-11-6" name="__codelineno-11-6"></a>reading csv file:  ./xtest.smat 18:14:50.269859
<a id="__codelineno-11-7" name="__codelineno-11-7"></a>preparing sparse mat 18:14:50.275748
<a id="__codelineno-11-8" name="__codelineno-11-8"></a>(&#39;ORIGDIM----&gt; &#39;, 11933, 3986, [11933], [3986])
<a id="__codelineno-11-9" name="__codelineno-11-9"></a>Running model definition
<a id="__codelineno-11-10" name="__codelineno-11-10"></a>10.0
<a id="__codelineno-11-11" name="__codelineno-11-11"></a>10.0
<a id="__codelineno-11-12" name="__codelineno-11-12"></a>2019-02-20 18:14:50.625090: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
<a id="__codelineno-11-13" name="__codelineno-11-13"></a>2019-02-20 18:14:51.702925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 0 with properties:
<a id="__codelineno-11-14" name="__codelineno-11-14"></a>name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.582
<a id="__codelineno-11-15" name="__codelineno-11-15"></a>pciBusID: 0000:02:00.0
<a id="__codelineno-11-16" name="__codelineno-11-16"></a>totalMemory: 10.92GiB freeMemory: 10.76GiB
<a id="__codelineno-11-17" name="__codelineno-11-17"></a>2019-02-20 18:14:51.702988: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0
<a id="__codelineno-11-18" name="__codelineno-11-18"></a>2019-02-20 18:14:52.051737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10415 MB memory) -&gt; physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:02:00.0, compute capability: 6.1)
<a id="__codelineno-11-19" name="__codelineno-11-19"></a>Generating an embedding (for testing)
<a id="__codelineno-11-20" name="__codelineno-11-20"></a>_________________________________________________________________
<a id="__codelineno-11-21" name="__codelineno-11-21"></a>Layer (type)                 Output Shape              Param #
<a id="__codelineno-11-22" name="__codelineno-11-22"></a>=================================================================
<a id="__codelineno-11-23" name="__codelineno-11-23"></a>input_1 (InputLayer)         (None, 11933)             0
<a id="__codelineno-11-24" name="__codelineno-11-24"></a>_________________________________________________________________
<a id="__codelineno-11-25" name="__codelineno-11-25"></a>dropout_1 (Dropout)          (None, 11933)             0
<a id="__codelineno-11-26" name="__codelineno-11-26"></a>_________________________________________________________________
<a id="__codelineno-11-27" name="__codelineno-11-27"></a>dense_1 (Dense)              (None, 400)               4773600
<a id="__codelineno-11-28" name="__codelineno-11-28"></a>_________________________________________________________________
<a id="__codelineno-11-29" name="__codelineno-11-29"></a>leaky_re_lu_1 (LeakyReLU)    (None, 400)               0
<a id="__codelineno-11-30" name="__codelineno-11-30"></a>_________________________________________________________________
<a id="__codelineno-11-31" name="__codelineno-11-31"></a>dropout_2 (Dropout)          (None, 400)               0
<a id="__codelineno-11-32" name="__codelineno-11-32"></a>_________________________________________________________________
<a id="__codelineno-11-33" name="__codelineno-11-33"></a>dense_2 (Dense)              (None, 200)               80200
<a id="__codelineno-11-34" name="__codelineno-11-34"></a>_________________________________________________________________
<a id="__codelineno-11-35" name="__codelineno-11-35"></a>leaky_re_lu_2 (LeakyReLU)    (None, 200)               0
<a id="__codelineno-11-36" name="__codelineno-11-36"></a>_________________________________________________________________
<a id="__codelineno-11-37" name="__codelineno-11-37"></a>dropout_3 (Dropout)          (None, 200)               0
<a id="__codelineno-11-38" name="__codelineno-11-38"></a>_________________________________________________________________
<a id="__codelineno-11-39" name="__codelineno-11-39"></a>dense_3 (Dense)              (None, 100)               20100
<a id="__codelineno-11-40" name="__codelineno-11-40"></a>_________________________________________________________________
<a id="__codelineno-11-41" name="__codelineno-11-41"></a>leaky_re_lu_3 (LeakyReLU)    (None, 100)               0
<a id="__codelineno-11-42" name="__codelineno-11-42"></a>_________________________________________________________________
<a id="__codelineno-11-43" name="__codelineno-11-43"></a>batch_normalization_1 (Batch (None, 100)               400
<a id="__codelineno-11-44" name="__codelineno-11-44"></a>=================================================================
<a id="__codelineno-11-45" name="__codelineno-11-45"></a>Total params: 4,874,300
<a id="__codelineno-11-46" name="__codelineno-11-46"></a>Trainable params: 4,874,100
<a id="__codelineno-11-47" name="__codelineno-11-47"></a>Non-trainable params: 200
<a id="__codelineno-11-48" name="__codelineno-11-48"></a>_________________________________________________________________
<a id="__codelineno-11-49" name="__codelineno-11-49"></a>[[ 0.5779214  -1.1393576  -1.2145319   0.719882    1.152698    2.7561216
<a id="__codelineno-11-50" name="__codelineno-11-50"></a>   4.7062497  -1.9202161   1.4628897  -0.28924894 -5.909066   -3.8524284
<a id="__codelineno-11-51" name="__codelineno-11-51"></a>   0.89937544 -1.7450757  -1.6244755   4.2109747   1.8999414   2.4285064
<a id="__codelineno-11-52" name="__codelineno-11-52"></a>   2.119122   -1.1817946   2.5119438   2.4076338  -1.6450381   2.5745249
<a id="__codelineno-11-53" name="__codelineno-11-53"></a>   1.3517776   5.6222005   3.1432505   0.97051287 -1.9321308   1.6599026
<a id="__codelineno-11-54" name="__codelineno-11-54"></a>  -1.135961    4.1045027  -5.8931293  -0.9852152  -0.22657108  3.0653677
<a id="__codelineno-11-55" name="__codelineno-11-55"></a>   2.6770768   1.325161   -3.7317533   0.78288555  2.749711   -0.71579885
<a id="__codelineno-11-56" name="__codelineno-11-56"></a>  -0.6447115  -0.54217243  2.1220136   0.16115046  1.6993942   4.197215
<a id="__codelineno-11-57" name="__codelineno-11-57"></a>  -1.103509   -2.8239236  -2.4093542   1.7677689  -3.7956572   1.0639849
<a id="__codelineno-11-58" name="__codelineno-11-58"></a>  -4.50788    -0.5759249   1.5213671  -0.01162529  2.6363235  -2.1107693
<a id="__codelineno-11-59" name="__codelineno-11-59"></a>   4.447809    4.9245405   1.1112337   1.6995897   2.810319   -2.2490163
<a id="__codelineno-11-60" name="__codelineno-11-60"></a>  -0.57630396  3.6462874   2.2628431   5.652481   -2.4730139   5.1024203
<a id="__codelineno-11-61" name="__codelineno-11-61"></a>   3.0555716   2.2935085  -1.472085   -0.3556919   0.70053387  3.6700687
<a id="__codelineno-11-62" name="__codelineno-11-62"></a>   4.944693   -6.186803    1.0003986   3.6284337  -4.352747    3.9384065
<a id="__codelineno-11-63" name="__codelineno-11-63"></a>  -0.5298457   1.7390456   0.1143899   1.6540909   2.9988813   0.4738245
<a id="__codelineno-11-64" name="__codelineno-11-64"></a>  -5.7533255   5.286108    4.581069    1.6037283  -0.42494774  2.3381634
<a id="__codelineno-11-65" name="__codelineno-11-65"></a>  -5.95912     2.1251287   5.0158515  -0.31940365]]
</code></pre></div></td></tr></table></div>
<p>We now want to do the same using our layers file and infrastructure:
layer 9 is usually the layer of the Embedding if you didn't change the Embedder.py script to run a different network</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a>./Embeddings<span class="w"> </span>--get_embedding<span class="w"> </span>--f_samples<span class="w"> </span>./t_1.samples<span class="w"> </span>--f_scheme<span class="w"> </span>../x.scheme<span class="w"> </span>--f_layers<span class="w"> </span>../emodel.layers<span class="w"> </span>--to_layer<span class="w"> </span><span class="m">9</span>
</code></pre></div></td></tr></table></div>
 </p>
<h3 id="results">results ...</h3>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-13-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-13-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-13-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-13-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-13-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-13-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-13-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-13-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-13-10">10</a></span>
<span class="normal"><a href="#__codelineno-13-11">11</a></span>
<span class="normal"><a href="#__codelineno-13-12">12</a></span>
<span class="normal"><a href="#__codelineno-13-13">13</a></span>
<span class="normal"><a href="#__codelineno-13-14">14</a></span>
<span class="normal"><a href="#__codelineno-13-15">15</a></span>
<span class="normal"><a href="#__codelineno-13-16">16</a></span>
<span class="normal"><a href="#__codelineno-13-17">17</a></span>
<span class="normal"><a href="#__codelineno-13-18">18</a></span>
<span class="normal"><a href="#__codelineno-13-19">19</a></span>
<span class="normal"><a href="#__codelineno-13-20">20</a></span>
<span class="normal"><a href="#__codelineno-13-21">21</a></span>
<span class="normal"><a href="#__codelineno-13-22">22</a></span>
<span class="normal"><a href="#__codelineno-13-23">23</a></span>
<span class="normal"><a href="#__codelineno-13-24">24</a></span>
<span class="normal"><a href="#__codelineno-13-25">25</a></span>
<span class="normal"><a href="#__codelineno-13-26">26</a></span>
<span class="normal"><a href="#__codelineno-13-27">27</a></span>
<span class="normal"><a href="#__codelineno-13-28">28</a></span>
<span class="normal"><a href="#__codelineno-13-29">29</a></span>
<span class="normal"><a href="#__codelineno-13-30">30</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a>initializing rep /home/Repositories/THIN/thin_jun2017/thin.repository
<a id="__codelineno-13-2" name="__codelineno-13-2"></a>Read 0 signals, 0 pids :: data  0.000GB :: idx  0.000GB :: tot  0.000GB
<a id="__codelineno-13-3" name="__codelineno-13-3"></a>Read data time 0.102909 seconds
<a id="__codelineno-13-4" name="__codelineno-13-4"></a>read_binary_data_alloc [../x.scheme] with crc32 [-63879080]
<a id="__codelineno-13-5" name="__codelineno-13-5"></a>read_from_file [../x.scheme] with crc32 [-63879080] and size [1892057]
<a id="__codelineno-13-6" name="__codelineno-13-6"></a>MedSamples: reading ./t_1.samples
<a id="__codelineno-13-7" name="__codelineno-13-7"></a>WARNING: header line contains unused fields [EVENT_FIELDS,]
<a id="__codelineno-13-8" name="__codelineno-13-8"></a>[date]=2, [id]=1, [outcome]=3, [outcome_date]=4, [split]=5,
<a id="__codelineno-13-9" name="__codelineno-13-9"></a>read [1] samples for [1] patient IDs. Skipped [0] records
<a id="__codelineno-13-10" name="__codelineno-13-10"></a>sorting samples by id, date
<a id="__codelineno-13-11" name="__codelineno-13-11"></a>Generating sparse mat for 1 lines
<a id="__codelineno-13-12" name="__codelineno-13-12"></a>Reading layers file ../emodel.layers
<a id="__codelineno-13-13" name="__codelineno-13-13"></a>ApplyKeras: Reading 0 : LAYER   type=dropout;name=dropout_1;drop_rate=0.000000
<a id="__codelineno-13-14" name="__codelineno-13-14"></a>ApplyKeras: Reading 1 : LAYER   type=dense;name=dense_1;activation=linear;in_dim=11933;out_dim=400;n_bias=400
<a id="__codelineno-13-15" name="__codelineno-13-15"></a>ApplyKeras: Reading 2 : LAYER   type=leaky;activation=leaky;name=leaky_re_lu_1;leaky_alpha=0.100000
<a id="__codelineno-13-16" name="__codelineno-13-16"></a>ApplyKeras: Reading 3 : LAYER   type=dropout;name=dropout_2;drop_rate=0.000000
<a id="__codelineno-13-17" name="__codelineno-13-17"></a>ApplyKeras: Reading 4 : LAYER   type=dense;name=dense_2;activation=linear;in_dim=400;out_dim=200;n_bias=200
<a id="__codelineno-13-18" name="__codelineno-13-18"></a>ApplyKeras: Reading 5 : LAYER   type=leaky;activation=leaky;name=leaky_re_lu_2;leaky_alpha=0.100000
<a id="__codelineno-13-19" name="__codelineno-13-19"></a>ApplyKeras: Reading 6 : LAYER   type=dropout;name=dropout_3;drop_rate=0.000000
<a id="__codelineno-13-20" name="__codelineno-13-20"></a>ApplyKeras: Reading 7 : LAYER   type=dense;name=dense_3;activation=linear;in_dim=200;out_dim=100;n_bias=100
<a id="__codelineno-13-21" name="__codelineno-13-21"></a>ApplyKeras: Reading 8 : LAYER   type=leaky;activation=leaky;name=leaky_re_lu_3;leaky_alpha=0.100000
<a id="__codelineno-13-22" name="__codelineno-13-22"></a>ApplyKeras: Reading 9 : LAYER   type=batch_normalization;name=batch_normalization_1;dim=100
<a id="__codelineno-13-23" name="__codelineno-13-23"></a>ApplyKeras: Reading 10 : LAYER  type=dropout;name=dropout_4;drop_rate=0.000000
<a id="__codelineno-13-24" name="__codelineno-13-24"></a>ApplyKeras: Reading 11 : LAYER  type=dropout;name=dropout_5;drop_rate=0.000000
<a id="__codelineno-13-25" name="__codelineno-13-25"></a>ApplyKeras: Reading 12 : LAYER  type=dense;name=dense_4;activation=linear;in_dim=100;out_dim=200;n_bias=200
<a id="__codelineno-13-26" name="__codelineno-13-26"></a>ApplyKeras: Reading 13 : LAYER  type=leaky;activation=leaky;name=leaky_re_lu_4;leaky_alpha=0.100000
<a id="__codelineno-13-27" name="__codelineno-13-27"></a>ApplyKeras: Reading 14 : LAYER  type=dropout;name=dropout_6;drop_rate=0.000000
<a id="__codelineno-13-28" name="__codelineno-13-28"></a>ApplyKeras: Reading 15 : LAYER  type=dense;name=dense_5;activation=linear;in_dim=200;out_dim=400;n_bias=400
<a id="__codelineno-13-29" name="__codelineno-13-29"></a>ApplyKeras: Reading 16 : LAYER  type=dense;name=dense_6;activation=sigmoid;in_dim=400;out_dim=3986;n_bias=3986
<a id="__codelineno-13-30" name="__codelineno-13-30"></a>Embedding[0] :  0.577931, -1.139361, -1.214531, 0.719889, 1.152678, 2.756100, 4.706246, -1.920236, 1.462890, -0.289272, -5.909092, -3.852452, 0.899393, -1.745082, -1.624470, 4.210994, 1.899885, 2.428522, 2.119110, -1.181803, 2.511931, 2.407662, -1.645038, 2.574553, 1.351748, 5.622195, 3.143245, 0.970485, -1.932137, 1.659895, -1.135962, 4.104524, -5.893116, -0.985202, -0.226589, 3.065342, 2.677109, 1.325170, -3.731724, 0.782854, 2.749709, -0.715786, -0.644691, -0.542146, 2.122007, 0.161158, 1.699387, 4.197234, -1.103530, -2.823920, -2.409330, 1.767769, -3.795663, 1.063999, -4.507883, -0.575921, 1.521367, -0.011617, 2.636321, -2.110771, 4.447805, 4.924530, 1.111231, 1.699584, 2.810309, -2.249007, -0.576356, 3.646280, 2.262861, 5.652493, -2.473031, 5.102398, 3.055582, 2.293494, -1.472100, -0.355688, 0.700531, 3.670066, 4.944662, -6.186786, 1.000359, 3.628438, -4.352755, 3.938388, -0.529864, 1.739041, 0.114385, 1.654087, 2.998851, 0.473810, -5.753366, 5.286112, 4.581021, 1.603754, -0.424938, 2.338176, -5.959126, 2.125135, 5.015850, -0.319395,
</code></pre></div></td></tr></table></div>
 
and as can be easily seen we indeed create the same Embedding !! We're good to go and use this embedding in our infrastructure.
note we got the same embedding up to ~1e-5 error which is just a numerical error difference. Our embedding is much more stable that this small difference
since we trained it with added noise 4 orders of magnitude larger. 
Another way to test this is to use the Flow --get_json_mat option with the right samples file, and the right json file (see below)
  </p>
<h2 id="step-8-using-embedding-in-a-medmodel-finally">Step 8 : Using Embedding In a MedModel (Finally !!)</h2>
<p>Once we have the .scheme file and the matching .layers file we can generate features using the "embedding" feature generator.
This feature generator will generate for each sample it's sparse x line, then run it through the embedding model , and add the layer output as features in the MedFeatures matrix.
To use embeddings as features add the following to your json</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span>
<span class="normal"><a href="#__codelineno-14-2">2</a></span>
<span class="normal"><a href="#__codelineno-14-3">3</a></span>
<span class="normal"><a href="#__codelineno-14-4">4</a></span>
<span class="normal"><a href="#__codelineno-14-5">5</a></span>
<span class="normal"><a href="#__codelineno-14-6">6</a></span>
<span class="normal"><a href="#__codelineno-14-7">7</a></span>
<span class="normal"><a href="#__codelineno-14-8">8</a></span>
<span class="normal"><a href="#__codelineno-14-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;action_type&quot;</span><span class="p">:</span><span class="w">    </span><span class="s2">&quot;feat_generator&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;fg_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;embedding&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="w">                        </span><span class="c1">// the name of the feature will be FTR_&lt;num&gt;.&lt;name_prefix&gt;.col_&lt;embedding column number&gt; , if using several embedding FGs give them different name_prefix names</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="w">                        </span><span class="nt">&quot;name_prefix&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Semi_AutoEncoder&quot;</span><span class="p">,</span>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="w">                        </span><span class="c1">// your x matrix scheme file</span>
<a id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="w">                        </span><span class="nt">&quot;f_scheme&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/nas1/Work/Users/Avi/test_problems/embedding_example/mats/x.scheme&quot;</span><span class="p">,</span>
<a id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="w">                        </span><span class="c1">// your layers file</span>
<a id="__codelineno-14-7" name="__codelineno-14-7"></a><span class="w">                        </span><span class="nt">&quot;f_layers&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/nas1/Work/Users/Avi/test_problems/embedding_example/mats/emodel_auto_xx.layers&quot;</span><span class="p">,</span>
<a id="__codelineno-14-8" name="__codelineno-14-8"></a><span class="w">                        </span><span class="c1">// layer to use for embedding, typical is 9 if you used the default Embedder.py script</span>
<a id="__codelineno-14-9" name="__codelineno-14-9"></a><span class="w">                        </span><span class="nt">&quot;to_layer&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;9&quot;</span><span class="p">},</span>
</code></pre></div></td></tr></table></div>
 </p>
<h2 id="step-9-results-for-mi-withwithout-embedding-withwithout-sigdep">Step 9 : Results for MI with/without Embedding , with/without SigDep</h2>
<p>We can now easily train models for our problem. We can use learn_1_B as our training samples and validate_1_B as our cross validation set, and validate_2 as an external test set.
Doing these tests in 4 flavors:</p>
<ul>
<li>No categorial signals<ul>
<li>We used "last", "min", "max", "avg", "last_delta", "last_time" on several time windows </li>
<li>signals : <ul>
<li>"Glucose", "BMI", "HbA1C", "Triglycerides", "LDL", "Cholesterol", "HDL", "Creatinine", "eGFR_CKD_EPI", "Urea", "Proteinuria_State", "ALT", "AST", "ALKP", "WBC", "RBC", "Hemoglobin", "Hematocrit", "RDW", "K+", "Na", "GGT", "Bilirubin", "CRP","BP"</li>
</ul>
</li>
</ul>
</li>
<li>Used also Smoking information, age, gender</li>
<li>Using Signal Dependency on Drugs and RC (choosing top 100 codes in each) to select correlated read codes.</li>
<li>Using Embeddings:<ul>
<li>Embeddings were trained once as an autoencoder (y matrix created at same times of x matrix) and once as a future-encoder in which y matrix was created on times 1 or 2 years a head.</li>
<li>Embedding dimension was 100</li>
</ul>
</li>
<li>Using both SigDep and Embeddings together.
 
Predictor used was the same for all cases: lightgbm with slightly optimized parameters.
Results are given for the 30-730 time window, ages 40-80 , we compare AUCs</li>
</ul>
<table><tbody>
<tr>
<th>Model</th>
<th>CV AUC</th>
<th>Test AUC</th>
</tr>
<tr>
<td>Labs</td>
<td>0.762</td>
<td>0.763</td>
</tr>
<tr>
<td>+SigDep</td>
<td>0.782</td>
<td>0.782</td>
</tr>
<tr>
<td>+Embeddings</td>
<td>0.785</td>
<td>0.787</td>
</tr>
<tr>
<td>+SigDep +Embeddings</td>
<td>0.787</td>
<td>0.789</td>
</tr>
</tbody></table>
<p>CI intervals are more or less +- 0.005
Some points:</p>
<ul>
<li>We see a very minor improvement for using Embeddings.<ul>
<li>This is a nice result , as it verifies the whole concept works.</li>
<li>There is a trend towards better results even in this model, and when going to 3y, 5y time windows it gets stronger</li>
</ul>
</li>
<li>Since the SigDep option is much simpler also when interprating the models , it is not clear Embeddings are preffered in this problem.</li>
<li>On the other hand the Embedding option is quite general and the same set of features could be used in many different models.</li>
<li>Also : it may be that finiding/training the right Embedding model will give an even larger boost.</li>
<li>interestingly there was also a very small improvement trend when using both together:<ul>
<li>Means most of the information captured by both methods is the same, but still each has some small information parts the other doesn't.
 
 
 
 </li>
</ul>
</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.top", "navigation.instant", "navigation.path", "navigation.indexes", "search", "search.highlight", "search.suggest", "content.code.copy", "content.action.edit", "content.action.view"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>